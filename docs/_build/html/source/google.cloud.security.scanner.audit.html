<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>google.cloud.security.scanner.audit package &mdash; Forseti Security 1.1.11 documentation</title>
    
    <link rel="stylesheet" href="../_static/alabaster.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../',
        VERSION:     '1.1.11',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <link rel="top" title="Forseti Security 1.1.11 documentation" href="../index.html" />
   
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head>
  <body role="document">  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="google-cloud-security-scanner-audit-package">
<h1>google.cloud.security.scanner.audit package<a class="headerlink" href="#google-cloud-security-scanner-audit-package" title="Permalink to this headline">¶</a></h1>
<div class="section" id="submodules">
<h2>Submodules<a class="headerlink" href="#submodules" title="Permalink to this headline">¶</a></h2>
</div>
<div class="section" id="module-google.cloud.security.scanner.audit.base_rules_engine">
<span id="google-cloud-security-scanner-audit-base-rules-engine-module"></span><h2>google.cloud.security.scanner.audit.base_rules_engine module<a class="headerlink" href="#module-google.cloud.security.scanner.audit.base_rules_engine" title="Permalink to this headline">¶</a></h2>
<p>Base class for policy scanner rules engines.</p>
<p>Loads YAML rules either from local file system or Cloud Storage bucket.</p>
<dl class="class">
<dt id="google.cloud.security.scanner.audit.base_rules_engine.BaseRuleBook">
<em class="property">class </em><code class="descclassname">google.cloud.security.scanner.audit.base_rules_engine.</code><code class="descname">BaseRuleBook</code><a class="reference internal" href="../_modules/google/cloud/security/scanner/audit/base_rules_engine.html#BaseRuleBook"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#google.cloud.security.scanner.audit.base_rules_engine.BaseRuleBook" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal"><span class="pre">object</span></code></p>
<p>Base class for RuleBooks.</p>
<p>The RuleBook class encapsulates the logic for how the RulesEngine will
lookup rules and find policy discrepancies. The actual structure of
the RuleBook depends on how rules should be applied. For example,
Organization resource rules would be applied in a hierarchical manner.</p>
<dl class="method">
<dt id="google.cloud.security.scanner.audit.base_rules_engine.BaseRuleBook.add_rule">
<code class="descname">add_rule</code><span class="sig-paren">(</span><em>rule_def</em>, <em>rule_index</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/google/cloud/security/scanner/audit/base_rules_engine.html#BaseRuleBook.add_rule"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#google.cloud.security.scanner.audit.base_rules_engine.BaseRuleBook.add_rule" title="Permalink to this definition">¶</a></dt>
<dd><p>Add rule to rule book.</p>
<dl class="docutils">
<dt>Args:</dt>
<dd>rule_def (dict): Add a rule definition to the rule book.
rule_index (int): The index of the rule.</dd>
<dt>Raises:</dt>
<dd>NotImplementedError: The method should be defined in subclass.</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="google.cloud.security.scanner.audit.base_rules_engine.BaseRulesEngine">
<em class="property">class </em><code class="descclassname">google.cloud.security.scanner.audit.base_rules_engine.</code><code class="descname">BaseRulesEngine</code><span class="sig-paren">(</span><em>rules_file_path=None</em>, <em>snapshot_timestamp=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/google/cloud/security/scanner/audit/base_rules_engine.html#BaseRulesEngine"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#google.cloud.security.scanner.audit.base_rules_engine.BaseRulesEngine" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal"><span class="pre">object</span></code></p>
<p>The base class for the rules engine.</p>
<dl class="method">
<dt id="google.cloud.security.scanner.audit.base_rules_engine.BaseRulesEngine.build_rule_book">
<code class="descname">build_rule_book</code><span class="sig-paren">(</span><em>global_configs</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/google/cloud/security/scanner/audit/base_rules_engine.html#BaseRulesEngine.build_rule_book"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#google.cloud.security.scanner.audit.base_rules_engine.BaseRulesEngine.build_rule_book" title="Permalink to this definition">¶</a></dt>
<dd><p>Build RuleBook from the rules definition file.</p>
<dl class="docutils">
<dt>Args:</dt>
<dd>global_configs (dict): The global Forseti configuration.</dd>
<dt>Raises:</dt>
<dd>NotImplementedError: The method should be defined in subclass.</dd>
</dl>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="module-google.cloud.security.scanner.audit.bigquery_rules_engine">
<span id="google-cloud-security-scanner-audit-bigquery-rules-engine-module"></span><h2>google.cloud.security.scanner.audit.bigquery_rules_engine module<a class="headerlink" href="#module-google.cloud.security.scanner.audit.bigquery_rules_engine" title="Permalink to this headline">¶</a></h2>
<p>Rules engine for Big Query data sets</p>
<dl class="class">
<dt id="google.cloud.security.scanner.audit.bigquery_rules_engine.BigqueryRuleBook">
<em class="property">class </em><code class="descclassname">google.cloud.security.scanner.audit.bigquery_rules_engine.</code><code class="descname">BigqueryRuleBook</code><span class="sig-paren">(</span><em>rule_defs=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/google/cloud/security/scanner/audit/bigquery_rules_engine.html#BigqueryRuleBook"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#google.cloud.security.scanner.audit.bigquery_rules_engine.BigqueryRuleBook" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#google.cloud.security.scanner.audit.base_rules_engine.BaseRuleBook" title="google.cloud.security.scanner.audit.base_rules_engine.BaseRuleBook"><code class="xref py py-class docutils literal"><span class="pre">google.cloud.security.scanner.audit.base_rules_engine.BaseRuleBook</span></code></a></p>
<p>The RuleBook for Big Query dataset resources.</p>
<dl class="method">
<dt id="google.cloud.security.scanner.audit.bigquery_rules_engine.BigqueryRuleBook.add_rule">
<code class="descname">add_rule</code><span class="sig-paren">(</span><em>rule_def</em>, <em>rule_index</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/google/cloud/security/scanner/audit/bigquery_rules_engine.html#BigqueryRuleBook.add_rule"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#google.cloud.security.scanner.audit.bigquery_rules_engine.BigqueryRuleBook.add_rule" title="Permalink to this definition">¶</a></dt>
<dd><p>Add a rule to the rule book.</p>
<dl class="docutils">
<dt>Args:</dt>
<dd><dl class="first last docutils">
<dt>rule_def (dict): A dictionary containing rule definition</dt>
<dd>properties.</dd>
<dt>rule_index (int): The index of the rule from the rule definitions.</dt>
<dd>Assigned automatically when the rule book is built.</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="google.cloud.security.scanner.audit.bigquery_rules_engine.BigqueryRuleBook.add_rules">
<code class="descname">add_rules</code><span class="sig-paren">(</span><em>rule_defs</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/google/cloud/security/scanner/audit/bigquery_rules_engine.html#BigqueryRuleBook.add_rules"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#google.cloud.security.scanner.audit.bigquery_rules_engine.BigqueryRuleBook.add_rules" title="Permalink to this definition">¶</a></dt>
<dd><p>Add rules to the rule book.</p>
<dl class="docutils">
<dt>Args:</dt>
<dd>rule_defs (dict): rule definitions dictionary.</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="google.cloud.security.scanner.audit.bigquery_rules_engine.BigqueryRuleBook.get_resource_rules">
<code class="descname">get_resource_rules</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/google/cloud/security/scanner/audit/bigquery_rules_engine.html#BigqueryRuleBook.get_resource_rules"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#google.cloud.security.scanner.audit.bigquery_rules_engine.BigqueryRuleBook.get_resource_rules" title="Permalink to this definition">¶</a></dt>
<dd><p>Get all the resource rules for (resource, RuleAppliesTo.*).</p>
<dl class="docutils">
<dt>Returns:</dt>
<dd>list: A list of ResourceRules.</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="google.cloud.security.scanner.audit.bigquery_rules_engine.BigqueryRulesEngine">
<em class="property">class </em><code class="descclassname">google.cloud.security.scanner.audit.bigquery_rules_engine.</code><code class="descname">BigqueryRulesEngine</code><span class="sig-paren">(</span><em>rules_file_path</em>, <em>snapshot_timestamp=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/google/cloud/security/scanner/audit/bigquery_rules_engine.html#BigqueryRulesEngine"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#google.cloud.security.scanner.audit.bigquery_rules_engine.BigqueryRulesEngine" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#google.cloud.security.scanner.audit.base_rules_engine.BaseRulesEngine" title="google.cloud.security.scanner.audit.base_rules_engine.BaseRulesEngine"><code class="xref py py-class docutils literal"><span class="pre">google.cloud.security.scanner.audit.base_rules_engine.BaseRulesEngine</span></code></a></p>
<p>Rules engine for Big Query data sets</p>
<dl class="method">
<dt id="google.cloud.security.scanner.audit.bigquery_rules_engine.BigqueryRulesEngine.add_rules">
<code class="descname">add_rules</code><span class="sig-paren">(</span><em>rules</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/google/cloud/security/scanner/audit/bigquery_rules_engine.html#BigqueryRulesEngine.add_rules"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#google.cloud.security.scanner.audit.bigquery_rules_engine.BigqueryRulesEngine.add_rules" title="Permalink to this definition">¶</a></dt>
<dd><p>Add rules to the rule book.</p>
<dl class="docutils">
<dt>Args:</dt>
<dd>rules (dict): rule definitions dictionary</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="google.cloud.security.scanner.audit.bigquery_rules_engine.BigqueryRulesEngine.build_rule_book">
<code class="descname">build_rule_book</code><span class="sig-paren">(</span><em>global_configs=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/google/cloud/security/scanner/audit/bigquery_rules_engine.html#BigqueryRulesEngine.build_rule_book"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#google.cloud.security.scanner.audit.bigquery_rules_engine.BigqueryRulesEngine.build_rule_book" title="Permalink to this definition">¶</a></dt>
<dd><p>Build BigqueryRuleBook from the rules definition file.</p>
<dl class="docutils">
<dt>Args:</dt>
<dd>global_configs (dict): Global configurations.</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="google.cloud.security.scanner.audit.bigquery_rules_engine.BigqueryRulesEngine.find_policy_violations">
<code class="descname">find_policy_violations</code><span class="sig-paren">(</span><em>bq_datasets</em>, <em>force_rebuild=False</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/google/cloud/security/scanner/audit/bigquery_rules_engine.html#BigqueryRulesEngine.find_policy_violations"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#google.cloud.security.scanner.audit.bigquery_rules_engine.BigqueryRulesEngine.find_policy_violations" title="Permalink to this definition">¶</a></dt>
<dd><p>Determine whether Big Query datasets violate rules.</p>
<dl class="docutils">
<dt>Args:</dt>
<dd><p class="first">bq_datasets (list): Object containing ACL data.
force_rebuild (bool): If True, rebuilds the rule book. This will</p>
<blockquote class="last">
<div>reload the rules definition file and add the rules to the book.</div></blockquote>
</dd>
<dt>Returns:</dt>
<dd>generator: A generator of rule violations.</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="google.cloud.security.scanner.audit.bigquery_rules_engine.Rule">
<em class="property">class </em><code class="descclassname">google.cloud.security.scanner.audit.bigquery_rules_engine.</code><code class="descname">Rule</code><span class="sig-paren">(</span><em>rule_name</em>, <em>rule_index</em>, <em>rules</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/google/cloud/security/scanner/audit/bigquery_rules_engine.html#Rule"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#google.cloud.security.scanner.audit.bigquery_rules_engine.Rule" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal"><span class="pre">object</span></code></p>
<p>Rule properties from the rule definition file.
Also finds violations.</p>
<dl class="class">
<dt id="google.cloud.security.scanner.audit.bigquery_rules_engine.Rule.RuleViolation">
<em class="property">class </em><code class="descname">RuleViolation</code><span class="sig-paren">(</span><em>domain</em>, <em>resource_id</em>, <em>special_group</em>, <em>group_email</em>, <em>rule_name</em>, <em>role</em>, <em>user_email</em>, <em>rule_index</em>, <em>dataset_id</em>, <em>violation_type</em>, <em>resource_type</em><span class="sig-paren">)</span><a class="headerlink" href="#google.cloud.security.scanner.audit.bigquery_rules_engine.Rule.RuleViolation" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal"><span class="pre">tuple</span></code></p>
<dl class="attribute">
<dt id="google.cloud.security.scanner.audit.bigquery_rules_engine.Rule.RuleViolation.dataset_id">
<code class="descname">dataset_id</code><a class="headerlink" href="#google.cloud.security.scanner.audit.bigquery_rules_engine.Rule.RuleViolation.dataset_id" title="Permalink to this definition">¶</a></dt>
<dd><p>Alias for field number 8</p>
</dd></dl>

<dl class="attribute">
<dt id="google.cloud.security.scanner.audit.bigquery_rules_engine.Rule.RuleViolation.domain">
<code class="descname">domain</code><a class="headerlink" href="#google.cloud.security.scanner.audit.bigquery_rules_engine.Rule.RuleViolation.domain" title="Permalink to this definition">¶</a></dt>
<dd><p>Alias for field number 0</p>
</dd></dl>

<dl class="attribute">
<dt id="google.cloud.security.scanner.audit.bigquery_rules_engine.Rule.RuleViolation.group_email">
<code class="descname">group_email</code><a class="headerlink" href="#google.cloud.security.scanner.audit.bigquery_rules_engine.Rule.RuleViolation.group_email" title="Permalink to this definition">¶</a></dt>
<dd><p>Alias for field number 3</p>
</dd></dl>

<dl class="attribute">
<dt id="google.cloud.security.scanner.audit.bigquery_rules_engine.Rule.RuleViolation.resource_id">
<code class="descname">resource_id</code><a class="headerlink" href="#google.cloud.security.scanner.audit.bigquery_rules_engine.Rule.RuleViolation.resource_id" title="Permalink to this definition">¶</a></dt>
<dd><p>Alias for field number 1</p>
</dd></dl>

<dl class="attribute">
<dt id="google.cloud.security.scanner.audit.bigquery_rules_engine.Rule.RuleViolation.resource_type">
<code class="descname">resource_type</code><a class="headerlink" href="#google.cloud.security.scanner.audit.bigquery_rules_engine.Rule.RuleViolation.resource_type" title="Permalink to this definition">¶</a></dt>
<dd><p>Alias for field number 10</p>
</dd></dl>

<dl class="attribute">
<dt id="google.cloud.security.scanner.audit.bigquery_rules_engine.Rule.RuleViolation.role">
<code class="descname">role</code><a class="headerlink" href="#google.cloud.security.scanner.audit.bigquery_rules_engine.Rule.RuleViolation.role" title="Permalink to this definition">¶</a></dt>
<dd><p>Alias for field number 5</p>
</dd></dl>

<dl class="attribute">
<dt id="google.cloud.security.scanner.audit.bigquery_rules_engine.Rule.RuleViolation.rule_index">
<code class="descname">rule_index</code><a class="headerlink" href="#google.cloud.security.scanner.audit.bigquery_rules_engine.Rule.RuleViolation.rule_index" title="Permalink to this definition">¶</a></dt>
<dd><p>Alias for field number 7</p>
</dd></dl>

<dl class="attribute">
<dt id="google.cloud.security.scanner.audit.bigquery_rules_engine.Rule.RuleViolation.rule_name">
<code class="descname">rule_name</code><a class="headerlink" href="#google.cloud.security.scanner.audit.bigquery_rules_engine.Rule.RuleViolation.rule_name" title="Permalink to this definition">¶</a></dt>
<dd><p>Alias for field number 4</p>
</dd></dl>

<dl class="attribute">
<dt id="google.cloud.security.scanner.audit.bigquery_rules_engine.Rule.RuleViolation.special_group">
<code class="descname">special_group</code><a class="headerlink" href="#google.cloud.security.scanner.audit.bigquery_rules_engine.Rule.RuleViolation.special_group" title="Permalink to this definition">¶</a></dt>
<dd><p>Alias for field number 2</p>
</dd></dl>

<dl class="attribute">
<dt id="google.cloud.security.scanner.audit.bigquery_rules_engine.Rule.RuleViolation.user_email">
<code class="descname">user_email</code><a class="headerlink" href="#google.cloud.security.scanner.audit.bigquery_rules_engine.Rule.RuleViolation.user_email" title="Permalink to this definition">¶</a></dt>
<dd><p>Alias for field number 6</p>
</dd></dl>

<dl class="attribute">
<dt id="google.cloud.security.scanner.audit.bigquery_rules_engine.Rule.RuleViolation.violation_type">
<code class="descname">violation_type</code><a class="headerlink" href="#google.cloud.security.scanner.audit.bigquery_rules_engine.Rule.RuleViolation.violation_type" title="Permalink to this definition">¶</a></dt>
<dd><p>Alias for field number 9</p>
</dd></dl>

</dd></dl>

<dl class="method">
<dt id="google.cloud.security.scanner.audit.bigquery_rules_engine.Rule.find_policy_violations">
<code class="descclassname">Rule.</code><code class="descname">find_policy_violations</code><span class="sig-paren">(</span><em>bigquery_acl</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/google/cloud/security/scanner/audit/bigquery_rules_engine.html#Rule.find_policy_violations"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#google.cloud.security.scanner.audit.bigquery_rules_engine.Rule.find_policy_violations" title="Permalink to this definition">¶</a></dt>
<dd><p>Find BigQuery acl violations in the rule book.</p>
<dl class="docutils">
<dt>Args:</dt>
<dd>bigquery_acl (BigqueryAccessControls): BigQuery ACL resource.</dd>
<dt>Yields:</dt>
<dd>namedtuple: Returns RuleViolation named tuple.</dd>
</dl>
</dd></dl>

<dl class="attribute">
<dt id="google.cloud.security.scanner.audit.bigquery_rules_engine.Rule.frozen_rule_attributes">
<code class="descclassname">Rule.</code><code class="descname">frozen_rule_attributes</code><em class="property"> = frozenset(['domain', 'resource_id', 'special_group', 'group_email', 'rule_name', 'role', 'user_email', 'rule_index', 'dataset_id', 'violation_type', 'resource_type'])</em><a class="headerlink" href="#google.cloud.security.scanner.audit.bigquery_rules_engine.Rule.frozen_rule_attributes" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="google.cloud.security.scanner.audit.bigquery_rules_engine.Rule.rule_violation_attributes">
<code class="descclassname">Rule.</code><code class="descname">rule_violation_attributes</code><em class="property"> = ['resource_type', 'resource_id', 'rule_name', 'rule_index', 'violation_type', 'dataset_id', 'role', 'special_group', 'user_email', 'domain', 'group_email']</em><a class="headerlink" href="#google.cloud.security.scanner.audit.bigquery_rules_engine.Rule.rule_violation_attributes" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

</div>
<div class="section" id="module-google.cloud.security.scanner.audit.blacklist_rules_engine">
<span id="google-cloud-security-scanner-audit-blacklist-rules-engine-module"></span><h2>google.cloud.security.scanner.audit.blacklist_rules_engine module<a class="headerlink" href="#module-google.cloud.security.scanner.audit.blacklist_rules_engine" title="Permalink to this headline">¶</a></h2>
<p>Rules engine for Blacklist of IP addresses.</p>
<dl class="class">
<dt id="google.cloud.security.scanner.audit.blacklist_rules_engine.BlacklistRuleBook">
<em class="property">class </em><code class="descclassname">google.cloud.security.scanner.audit.blacklist_rules_engine.</code><code class="descname">BlacklistRuleBook</code><span class="sig-paren">(</span><em>rule_defs=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/google/cloud/security/scanner/audit/blacklist_rules_engine.html#BlacklistRuleBook"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#google.cloud.security.scanner.audit.blacklist_rules_engine.BlacklistRuleBook" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#google.cloud.security.scanner.audit.base_rules_engine.BaseRuleBook" title="google.cloud.security.scanner.audit.base_rules_engine.BaseRuleBook"><code class="xref py py-class docutils literal"><span class="pre">google.cloud.security.scanner.audit.base_rules_engine.BaseRuleBook</span></code></a></p>
<p>The RuleBook for networks resources.</p>
<dl class="method">
<dt id="google.cloud.security.scanner.audit.blacklist_rules_engine.BlacklistRuleBook.add_rule">
<code class="descname">add_rule</code><span class="sig-paren">(</span><em>rule_def</em>, <em>rule_index</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/google/cloud/security/scanner/audit/blacklist_rules_engine.html#BlacklistRuleBook.add_rule"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#google.cloud.security.scanner.audit.blacklist_rules_engine.BlacklistRuleBook.add_rule" title="Permalink to this definition">¶</a></dt>
<dd><p>Add a rule to the rule book.
Args:</p>
<blockquote>
<div><dl class="docutils">
<dt>rule_def (dict): A dictionary containing rule definition</dt>
<dd>properties.</dd>
<dt>rule_index (int): The index of the rule from the rule definitions.</dt>
<dd>Assigned automatically when the rule book is built.</dd>
</dl>
</div></blockquote>
</dd></dl>

<dl class="method">
<dt id="google.cloud.security.scanner.audit.blacklist_rules_engine.BlacklistRuleBook.add_rules">
<code class="descname">add_rules</code><span class="sig-paren">(</span><em>rule_defs</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/google/cloud/security/scanner/audit/blacklist_rules_engine.html#BlacklistRuleBook.add_rules"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#google.cloud.security.scanner.audit.blacklist_rules_engine.BlacklistRuleBook.add_rules" title="Permalink to this definition">¶</a></dt>
<dd><p>Add rules to the rule book.</p>
<dl class="docutils">
<dt>Args:</dt>
<dd>rule_defs (dict): rules definitions</dd>
</dl>
</dd></dl>

<dl class="staticmethod">
<dt id="google.cloud.security.scanner.audit.blacklist_rules_engine.BlacklistRuleBook.get_and_parse_blacklist">
<em class="property">static </em><code class="descname">get_and_parse_blacklist</code><span class="sig-paren">(</span><em>url</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/google/cloud/security/scanner/audit/blacklist_rules_engine.html#BlacklistRuleBook.get_and_parse_blacklist"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#google.cloud.security.scanner.audit.blacklist_rules_engine.BlacklistRuleBook.get_and_parse_blacklist" title="Permalink to this definition">¶</a></dt>
<dd><p>Download blacklist and parse it into IPs and netblocks.</p>
<dl class="docutils">
<dt>Args:</dt>
<dd>url (str): url to download blacklist from</dd>
<dt>Returns:</dt>
<dd>lists: first one is IP addresses,
second one is network blocks</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="google.cloud.security.scanner.audit.blacklist_rules_engine.BlacklistRuleBook.get_resource_rules">
<code class="descname">get_resource_rules</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/google/cloud/security/scanner/audit/blacklist_rules_engine.html#BlacklistRuleBook.get_resource_rules"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#google.cloud.security.scanner.audit.blacklist_rules_engine.BlacklistRuleBook.get_resource_rules" title="Permalink to this definition">¶</a></dt>
<dd><p>Get all the resource rules for (resource, RuleAppliesTo.*).</p>
<dl class="docutils">
<dt>Returns:</dt>
<dd>list:  A list of ResourceRules.</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="google.cloud.security.scanner.audit.blacklist_rules_engine.BlacklistRulesEngine">
<em class="property">class </em><code class="descclassname">google.cloud.security.scanner.audit.blacklist_rules_engine.</code><code class="descname">BlacklistRulesEngine</code><span class="sig-paren">(</span><em>rules_file_path</em>, <em>snapshot_timestamp=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/google/cloud/security/scanner/audit/blacklist_rules_engine.html#BlacklistRulesEngine"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#google.cloud.security.scanner.audit.blacklist_rules_engine.BlacklistRulesEngine" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#google.cloud.security.scanner.audit.base_rules_engine.BaseRulesEngine" title="google.cloud.security.scanner.audit.base_rules_engine.BaseRulesEngine"><code class="xref py py-class docutils literal"><span class="pre">google.cloud.security.scanner.audit.base_rules_engine.BaseRulesEngine</span></code></a></p>
<p>Rules engine for BlacklistRules.</p>
<dl class="method">
<dt id="google.cloud.security.scanner.audit.blacklist_rules_engine.BlacklistRulesEngine.add_rules">
<code class="descname">add_rules</code><span class="sig-paren">(</span><em>rules</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/google/cloud/security/scanner/audit/blacklist_rules_engine.html#BlacklistRulesEngine.add_rules"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#google.cloud.security.scanner.audit.blacklist_rules_engine.BlacklistRulesEngine.add_rules" title="Permalink to this definition">¶</a></dt>
<dd><p>Add rules to the rule book.</p>
<dl class="docutils">
<dt>Args:</dt>
<dd>rules (dicts): rule definitions</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="google.cloud.security.scanner.audit.blacklist_rules_engine.BlacklistRulesEngine.build_rule_book">
<code class="descname">build_rule_book</code><span class="sig-paren">(</span><em>global_configs=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/google/cloud/security/scanner/audit/blacklist_rules_engine.html#BlacklistRulesEngine.build_rule_book"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#google.cloud.security.scanner.audit.blacklist_rules_engine.BlacklistRulesEngine.build_rule_book" title="Permalink to this definition">¶</a></dt>
<dd><p>Build BlacklistRuleBook from rules definition file.</p>
<dl class="docutils">
<dt>Args:</dt>
<dd>global_configs (dict): Global Configs</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="google.cloud.security.scanner.audit.blacklist_rules_engine.BlacklistRulesEngine.find_policy_violations">
<code class="descname">find_policy_violations</code><span class="sig-paren">(</span><em>instance_network_interface</em>, <em>force_rebuild=False</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/google/cloud/security/scanner/audit/blacklist_rules_engine.html#BlacklistRulesEngine.find_policy_violations"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#google.cloud.security.scanner.audit.blacklist_rules_engine.BlacklistRulesEngine.find_policy_violations" title="Permalink to this definition">¶</a></dt>
<dd><p>Determine whether the networks violates rules.</p>
<dl class="docutils">
<dt>Args:</dt>
<dd><dl class="first docutils">
<dt>instance_network_interface (list): list of</dt>
<dd>instance_network_interface</dd>
</dl>
<p class="last">force_rebuild (bool): set to false to not force a rebuiid</p>
</dd>
<dt>Return:</dt>
<dd>list: iterator of all violations</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="google.cloud.security.scanner.audit.blacklist_rules_engine.Rule">
<em class="property">class </em><code class="descclassname">google.cloud.security.scanner.audit.blacklist_rules_engine.</code><code class="descname">Rule</code><span class="sig-paren">(</span><em>rule_blacklist</em>, <em>rule_index</em>, <em>rules</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/google/cloud/security/scanner/audit/blacklist_rules_engine.html#Rule"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#google.cloud.security.scanner.audit.blacklist_rules_engine.Rule" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal"><span class="pre">object</span></code></p>
<p>The rules class for instance_network_interface.</p>
<dl class="class">
<dt id="google.cloud.security.scanner.audit.blacklist_rules_engine.Rule.RuleViolation">
<em class="property">class </em><code class="descname">RuleViolation</code><span class="sig-paren">(</span><em>resource_type</em>, <em>rule_blacklist</em>, <em>rule_name</em>, <em>rule_index</em>, <em>violation_type</em>, <em>project</em>, <em>network</em>, <em>ip</em><span class="sig-paren">)</span><a class="headerlink" href="#google.cloud.security.scanner.audit.blacklist_rules_engine.Rule.RuleViolation" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal"><span class="pre">tuple</span></code></p>
<dl class="attribute">
<dt id="google.cloud.security.scanner.audit.blacklist_rules_engine.Rule.RuleViolation.ip">
<code class="descname">ip</code><a class="headerlink" href="#google.cloud.security.scanner.audit.blacklist_rules_engine.Rule.RuleViolation.ip" title="Permalink to this definition">¶</a></dt>
<dd><p>Alias for field number 7</p>
</dd></dl>

<dl class="attribute">
<dt id="google.cloud.security.scanner.audit.blacklist_rules_engine.Rule.RuleViolation.network">
<code class="descname">network</code><a class="headerlink" href="#google.cloud.security.scanner.audit.blacklist_rules_engine.Rule.RuleViolation.network" title="Permalink to this definition">¶</a></dt>
<dd><p>Alias for field number 6</p>
</dd></dl>

<dl class="attribute">
<dt id="google.cloud.security.scanner.audit.blacklist_rules_engine.Rule.RuleViolation.project">
<code class="descname">project</code><a class="headerlink" href="#google.cloud.security.scanner.audit.blacklist_rules_engine.Rule.RuleViolation.project" title="Permalink to this definition">¶</a></dt>
<dd><p>Alias for field number 5</p>
</dd></dl>

<dl class="attribute">
<dt id="google.cloud.security.scanner.audit.blacklist_rules_engine.Rule.RuleViolation.resource_type">
<code class="descname">resource_type</code><a class="headerlink" href="#google.cloud.security.scanner.audit.blacklist_rules_engine.Rule.RuleViolation.resource_type" title="Permalink to this definition">¶</a></dt>
<dd><p>Alias for field number 0</p>
</dd></dl>

<dl class="attribute">
<dt id="google.cloud.security.scanner.audit.blacklist_rules_engine.Rule.RuleViolation.rule_blacklist">
<code class="descname">rule_blacklist</code><a class="headerlink" href="#google.cloud.security.scanner.audit.blacklist_rules_engine.Rule.RuleViolation.rule_blacklist" title="Permalink to this definition">¶</a></dt>
<dd><p>Alias for field number 1</p>
</dd></dl>

<dl class="attribute">
<dt id="google.cloud.security.scanner.audit.blacklist_rules_engine.Rule.RuleViolation.rule_index">
<code class="descname">rule_index</code><a class="headerlink" href="#google.cloud.security.scanner.audit.blacklist_rules_engine.Rule.RuleViolation.rule_index" title="Permalink to this definition">¶</a></dt>
<dd><p>Alias for field number 3</p>
</dd></dl>

<dl class="attribute">
<dt id="google.cloud.security.scanner.audit.blacklist_rules_engine.Rule.RuleViolation.rule_name">
<code class="descname">rule_name</code><a class="headerlink" href="#google.cloud.security.scanner.audit.blacklist_rules_engine.Rule.RuleViolation.rule_name" title="Permalink to this definition">¶</a></dt>
<dd><p>Alias for field number 2</p>
</dd></dl>

<dl class="attribute">
<dt id="google.cloud.security.scanner.audit.blacklist_rules_engine.Rule.RuleViolation.violation_type">
<code class="descname">violation_type</code><a class="headerlink" href="#google.cloud.security.scanner.audit.blacklist_rules_engine.Rule.RuleViolation.violation_type" title="Permalink to this definition">¶</a></dt>
<dd><p>Alias for field number 4</p>
</dd></dl>

</dd></dl>

<dl class="staticmethod">
<dt id="google.cloud.security.scanner.audit.blacklist_rules_engine.Rule.address_in_network">
<em class="property">static </em><code class="descclassname">Rule.</code><code class="descname">address_in_network</code><span class="sig-paren">(</span><em>ipaddr</em>, <em>net</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/google/cloud/security/scanner/audit/blacklist_rules_engine.html#Rule.address_in_network"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#google.cloud.security.scanner.audit.blacklist_rules_engine.Rule.address_in_network" title="Permalink to this definition">¶</a></dt>
<dd><p>Checks if ip address is in net</p>
<dl class="docutils">
<dt>Args:</dt>
<dd>ipaddr (str): IP address to check
net (str): network to check</dd>
<dt>Returns:</dt>
<dd>bool: True if ipaddr in net</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="google.cloud.security.scanner.audit.blacklist_rules_engine.Rule.find_violations">
<code class="descclassname">Rule.</code><code class="descname">find_violations</code><span class="sig-paren">(</span><em>instance_network_interface</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/google/cloud/security/scanner/audit/blacklist_rules_engine.html#Rule.find_violations"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#google.cloud.security.scanner.audit.blacklist_rules_engine.Rule.find_violations" title="Permalink to this definition">¶</a></dt>
<dd><p>Raise violation if the IP is not in the whitelist.</p>
<dl class="docutils">
<dt>Args:</dt>
<dd>instance_network_interface (InstanceNetworkInterface): object</dd>
<dt>Yields:</dt>
<dd>namedtuple: Returns RuleViolation named tuple</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="google.cloud.security.scanner.audit.blacklist_rules_engine.Rule.is_blacklisted">
<code class="descclassname">Rule.</code><code class="descname">is_blacklisted</code><span class="sig-paren">(</span><em>ipaddr</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/google/cloud/security/scanner/audit/blacklist_rules_engine.html#Rule.is_blacklisted"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#google.cloud.security.scanner.audit.blacklist_rules_engine.Rule.is_blacklisted" title="Permalink to this definition">¶</a></dt>
<dd><p>Checks if ip address is in a blacklist</p>
<dl class="docutils">
<dt>Args:</dt>
<dd>ipaddr (str): IP address to check</dd>
<dt>Returns:</dt>
<dd>bool: True if ipaddr is blacklisted</dd>
</dl>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="module-google.cloud.security.scanner.audit.buckets_rules_engine">
<span id="google-cloud-security-scanner-audit-buckets-rules-engine-module"></span><h2>google.cloud.security.scanner.audit.buckets_rules_engine module<a class="headerlink" href="#module-google.cloud.security.scanner.audit.buckets_rules_engine" title="Permalink to this headline">¶</a></h2>
<p>Rules engine for Bucket acls</p>
<dl class="class">
<dt id="google.cloud.security.scanner.audit.buckets_rules_engine.BucketsRuleBook">
<em class="property">class </em><code class="descclassname">google.cloud.security.scanner.audit.buckets_rules_engine.</code><code class="descname">BucketsRuleBook</code><span class="sig-paren">(</span><em>rule_defs=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/google/cloud/security/scanner/audit/buckets_rules_engine.html#BucketsRuleBook"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#google.cloud.security.scanner.audit.buckets_rules_engine.BucketsRuleBook" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#google.cloud.security.scanner.audit.base_rules_engine.BaseRuleBook" title="google.cloud.security.scanner.audit.base_rules_engine.BaseRuleBook"><code class="xref py py-class docutils literal"><span class="pre">google.cloud.security.scanner.audit.base_rules_engine.BaseRuleBook</span></code></a></p>
<p>The RuleBook for bucket acls resources.</p>
<dl class="method">
<dt id="google.cloud.security.scanner.audit.buckets_rules_engine.BucketsRuleBook.add_rule">
<code class="descname">add_rule</code><span class="sig-paren">(</span><em>rule_def</em>, <em>rule_index</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/google/cloud/security/scanner/audit/buckets_rules_engine.html#BucketsRuleBook.add_rule"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#google.cloud.security.scanner.audit.buckets_rules_engine.BucketsRuleBook.add_rule" title="Permalink to this definition">¶</a></dt>
<dd><p>Add a rule to the rule book.</p>
<dl class="docutils">
<dt>Args:</dt>
<dd><dl class="first last docutils">
<dt>rule_def (dict): A dictionary containing rule definition</dt>
<dd>properties.</dd>
<dt>rule_index (int): The index of the rule from the rule definitions.</dt>
<dd>Assigned automatically when the rule book is built.</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="google.cloud.security.scanner.audit.buckets_rules_engine.BucketsRuleBook.add_rules">
<code class="descname">add_rules</code><span class="sig-paren">(</span><em>rule_defs</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/google/cloud/security/scanner/audit/buckets_rules_engine.html#BucketsRuleBook.add_rules"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#google.cloud.security.scanner.audit.buckets_rules_engine.BucketsRuleBook.add_rules" title="Permalink to this definition">¶</a></dt>
<dd><p>Add rules to the rule book</p>
<dl class="docutils">
<dt>Args:</dt>
<dd>rule_defs (dict): rule definitions dictionary</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="google.cloud.security.scanner.audit.buckets_rules_engine.BucketsRuleBook.get_resource_rules">
<code class="descname">get_resource_rules</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/google/cloud/security/scanner/audit/buckets_rules_engine.html#BucketsRuleBook.get_resource_rules"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#google.cloud.security.scanner.audit.buckets_rules_engine.BucketsRuleBook.get_resource_rules" title="Permalink to this definition">¶</a></dt>
<dd><p>Get all the resource rules for (resource, RuleAppliesTo.*).</p>
<dl class="docutils">
<dt>Returns:</dt>
<dd>list:  A list of ResourceRules.</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="google.cloud.security.scanner.audit.buckets_rules_engine.BucketsRulesEngine">
<em class="property">class </em><code class="descclassname">google.cloud.security.scanner.audit.buckets_rules_engine.</code><code class="descname">BucketsRulesEngine</code><span class="sig-paren">(</span><em>rules_file_path</em>, <em>snapshot_timestamp=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/google/cloud/security/scanner/audit/buckets_rules_engine.html#BucketsRulesEngine"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#google.cloud.security.scanner.audit.buckets_rules_engine.BucketsRulesEngine" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#google.cloud.security.scanner.audit.base_rules_engine.BaseRulesEngine" title="google.cloud.security.scanner.audit.base_rules_engine.BaseRulesEngine"><code class="xref py py-class docutils literal"><span class="pre">google.cloud.security.scanner.audit.base_rules_engine.BaseRulesEngine</span></code></a></p>
<p>Rules engine for bucket acls</p>
<dl class="method">
<dt id="google.cloud.security.scanner.audit.buckets_rules_engine.BucketsRulesEngine.add_rules">
<code class="descname">add_rules</code><span class="sig-paren">(</span><em>rules</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/google/cloud/security/scanner/audit/buckets_rules_engine.html#BucketsRulesEngine.add_rules"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#google.cloud.security.scanner.audit.buckets_rules_engine.BucketsRulesEngine.add_rules" title="Permalink to this definition">¶</a></dt>
<dd><p>Add rules to the rule book.</p>
<dl class="docutils">
<dt>Args:</dt>
<dd>rules (dict): rule definitions dictionary</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="google.cloud.security.scanner.audit.buckets_rules_engine.BucketsRulesEngine.build_rule_book">
<code class="descname">build_rule_book</code><span class="sig-paren">(</span><em>global_configs=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/google/cloud/security/scanner/audit/buckets_rules_engine.html#BucketsRulesEngine.build_rule_book"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#google.cloud.security.scanner.audit.buckets_rules_engine.BucketsRulesEngine.build_rule_book" title="Permalink to this definition">¶</a></dt>
<dd><p>Build BucketsRuleBook from the rules definition file.</p>
<dl class="docutils">
<dt>Args:</dt>
<dd>global_configs (dict): Global configurations.</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="google.cloud.security.scanner.audit.buckets_rules_engine.BucketsRulesEngine.find_policy_violations">
<code class="descname">find_policy_violations</code><span class="sig-paren">(</span><em>buckets_acls</em>, <em>force_rebuild=False</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/google/cloud/security/scanner/audit/buckets_rules_engine.html#BucketsRulesEngine.find_policy_violations"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#google.cloud.security.scanner.audit.buckets_rules_engine.BucketsRulesEngine.find_policy_violations" title="Permalink to this definition">¶</a></dt>
<dd><p>Determine whether bucket acls violates rules.</p>
<dl class="docutils">
<dt>Args:</dt>
<dd><dl class="first last docutils">
<dt>buckets_acls (BucketAccessControls): Object containing ACL</dt>
<dd>data</dd>
<dt>force_rebuild (bool): If True, rebuilds the rule book. This will</dt>
<dd>reload the rules definition file and add the rules to the book.</dd>
</dl>
</dd>
<dt>Returns:</dt>
<dd>generator: A generator of rule violations.</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="google.cloud.security.scanner.audit.buckets_rules_engine.Rule">
<em class="property">class </em><code class="descclassname">google.cloud.security.scanner.audit.buckets_rules_engine.</code><code class="descname">Rule</code><span class="sig-paren">(</span><em>rule_name</em>, <em>rule_index</em>, <em>rules</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/google/cloud/security/scanner/audit/buckets_rules_engine.html#Rule"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#google.cloud.security.scanner.audit.buckets_rules_engine.Rule" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal"><span class="pre">object</span></code></p>
<p>Rule properties from the rule definition file.
Also finds violations.</p>
<dl class="class">
<dt id="google.cloud.security.scanner.audit.buckets_rules_engine.Rule.RuleViolation">
<em class="property">class </em><code class="descname">RuleViolation</code><span class="sig-paren">(</span><em>resource_type</em>, <em>resource_id</em>, <em>rule_name</em>, <em>rule_index</em>, <em>violation_type</em>, <em>role</em>, <em>entity</em>, <em>email</em>, <em>domain</em>, <em>bucket</em>, <em>project_number</em><span class="sig-paren">)</span><a class="headerlink" href="#google.cloud.security.scanner.audit.buckets_rules_engine.Rule.RuleViolation" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal"><span class="pre">tuple</span></code></p>
<dl class="attribute">
<dt id="google.cloud.security.scanner.audit.buckets_rules_engine.Rule.RuleViolation.bucket">
<code class="descname">bucket</code><a class="headerlink" href="#google.cloud.security.scanner.audit.buckets_rules_engine.Rule.RuleViolation.bucket" title="Permalink to this definition">¶</a></dt>
<dd><p>Alias for field number 9</p>
</dd></dl>

<dl class="attribute">
<dt id="google.cloud.security.scanner.audit.buckets_rules_engine.Rule.RuleViolation.domain">
<code class="descname">domain</code><a class="headerlink" href="#google.cloud.security.scanner.audit.buckets_rules_engine.Rule.RuleViolation.domain" title="Permalink to this definition">¶</a></dt>
<dd><p>Alias for field number 8</p>
</dd></dl>

<dl class="attribute">
<dt id="google.cloud.security.scanner.audit.buckets_rules_engine.Rule.RuleViolation.email">
<code class="descname">email</code><a class="headerlink" href="#google.cloud.security.scanner.audit.buckets_rules_engine.Rule.RuleViolation.email" title="Permalink to this definition">¶</a></dt>
<dd><p>Alias for field number 7</p>
</dd></dl>

<dl class="attribute">
<dt id="google.cloud.security.scanner.audit.buckets_rules_engine.Rule.RuleViolation.entity">
<code class="descname">entity</code><a class="headerlink" href="#google.cloud.security.scanner.audit.buckets_rules_engine.Rule.RuleViolation.entity" title="Permalink to this definition">¶</a></dt>
<dd><p>Alias for field number 6</p>
</dd></dl>

<dl class="attribute">
<dt id="google.cloud.security.scanner.audit.buckets_rules_engine.Rule.RuleViolation.project_number">
<code class="descname">project_number</code><a class="headerlink" href="#google.cloud.security.scanner.audit.buckets_rules_engine.Rule.RuleViolation.project_number" title="Permalink to this definition">¶</a></dt>
<dd><p>Alias for field number 10</p>
</dd></dl>

<dl class="attribute">
<dt id="google.cloud.security.scanner.audit.buckets_rules_engine.Rule.RuleViolation.resource_id">
<code class="descname">resource_id</code><a class="headerlink" href="#google.cloud.security.scanner.audit.buckets_rules_engine.Rule.RuleViolation.resource_id" title="Permalink to this definition">¶</a></dt>
<dd><p>Alias for field number 1</p>
</dd></dl>

<dl class="attribute">
<dt id="google.cloud.security.scanner.audit.buckets_rules_engine.Rule.RuleViolation.resource_type">
<code class="descname">resource_type</code><a class="headerlink" href="#google.cloud.security.scanner.audit.buckets_rules_engine.Rule.RuleViolation.resource_type" title="Permalink to this definition">¶</a></dt>
<dd><p>Alias for field number 0</p>
</dd></dl>

<dl class="attribute">
<dt id="google.cloud.security.scanner.audit.buckets_rules_engine.Rule.RuleViolation.role">
<code class="descname">role</code><a class="headerlink" href="#google.cloud.security.scanner.audit.buckets_rules_engine.Rule.RuleViolation.role" title="Permalink to this definition">¶</a></dt>
<dd><p>Alias for field number 5</p>
</dd></dl>

<dl class="attribute">
<dt id="google.cloud.security.scanner.audit.buckets_rules_engine.Rule.RuleViolation.rule_index">
<code class="descname">rule_index</code><a class="headerlink" href="#google.cloud.security.scanner.audit.buckets_rules_engine.Rule.RuleViolation.rule_index" title="Permalink to this definition">¶</a></dt>
<dd><p>Alias for field number 3</p>
</dd></dl>

<dl class="attribute">
<dt id="google.cloud.security.scanner.audit.buckets_rules_engine.Rule.RuleViolation.rule_name">
<code class="descname">rule_name</code><a class="headerlink" href="#google.cloud.security.scanner.audit.buckets_rules_engine.Rule.RuleViolation.rule_name" title="Permalink to this definition">¶</a></dt>
<dd><p>Alias for field number 2</p>
</dd></dl>

<dl class="attribute">
<dt id="google.cloud.security.scanner.audit.buckets_rules_engine.Rule.RuleViolation.violation_type">
<code class="descname">violation_type</code><a class="headerlink" href="#google.cloud.security.scanner.audit.buckets_rules_engine.Rule.RuleViolation.violation_type" title="Permalink to this definition">¶</a></dt>
<dd><p>Alias for field number 4</p>
</dd></dl>

</dd></dl>

<dl class="method">
<dt id="google.cloud.security.scanner.audit.buckets_rules_engine.Rule.find_policy_violations">
<code class="descclassname">Rule.</code><code class="descname">find_policy_violations</code><span class="sig-paren">(</span><em>bucket_acl</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/google/cloud/security/scanner/audit/buckets_rules_engine.html#Rule.find_policy_violations"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#google.cloud.security.scanner.audit.buckets_rules_engine.Rule.find_policy_violations" title="Permalink to this definition">¶</a></dt>
<dd><p>Find bucket policy acl violations in the rule book.</p>
<dl class="docutils">
<dt>Args:</dt>
<dd>bucket_acl (BucketAccessControls): Bucket ACL resource</dd>
<dt>Yields:</dt>
<dd>namedtuple: Returns RuleViolation named tuple</dd>
</dl>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="module-google.cloud.security.scanner.audit.cloudsql_rules_engine">
<span id="google-cloud-security-scanner-audit-cloudsql-rules-engine-module"></span><h2>google.cloud.security.scanner.audit.cloudsql_rules_engine module<a class="headerlink" href="#module-google.cloud.security.scanner.audit.cloudsql_rules_engine" title="Permalink to this headline">¶</a></h2>
<p>Rules engine for CloudSQL acls</p>
<dl class="class">
<dt id="google.cloud.security.scanner.audit.cloudsql_rules_engine.CloudSqlRuleBook">
<em class="property">class </em><code class="descclassname">google.cloud.security.scanner.audit.cloudsql_rules_engine.</code><code class="descname">CloudSqlRuleBook</code><span class="sig-paren">(</span><em>rule_defs=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/google/cloud/security/scanner/audit/cloudsql_rules_engine.html#CloudSqlRuleBook"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#google.cloud.security.scanner.audit.cloudsql_rules_engine.CloudSqlRuleBook" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#google.cloud.security.scanner.audit.base_rules_engine.BaseRuleBook" title="google.cloud.security.scanner.audit.base_rules_engine.BaseRuleBook"><code class="xref py py-class docutils literal"><span class="pre">google.cloud.security.scanner.audit.base_rules_engine.BaseRuleBook</span></code></a></p>
<p>The RuleBook for CloudSQL acls resources.</p>
<dl class="method">
<dt id="google.cloud.security.scanner.audit.cloudsql_rules_engine.CloudSqlRuleBook.add_rule">
<code class="descname">add_rule</code><span class="sig-paren">(</span><em>rule_def</em>, <em>rule_index</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/google/cloud/security/scanner/audit/cloudsql_rules_engine.html#CloudSqlRuleBook.add_rule"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#google.cloud.security.scanner.audit.cloudsql_rules_engine.CloudSqlRuleBook.add_rule" title="Permalink to this definition">¶</a></dt>
<dd><p>Add a rule to the rule book.</p>
<dl class="docutils">
<dt>Args:</dt>
<dd><dl class="first last docutils">
<dt>rule_def (dict): A dictionary containing rule definition</dt>
<dd>properties.</dd>
<dt>rule_index (int): The index of the rule from the rule definitions.</dt>
<dd>Assigned automatically when the rule book is built.</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="google.cloud.security.scanner.audit.cloudsql_rules_engine.CloudSqlRuleBook.add_rules">
<code class="descname">add_rules</code><span class="sig-paren">(</span><em>rule_defs</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/google/cloud/security/scanner/audit/cloudsql_rules_engine.html#CloudSqlRuleBook.add_rules"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#google.cloud.security.scanner.audit.cloudsql_rules_engine.CloudSqlRuleBook.add_rules" title="Permalink to this definition">¶</a></dt>
<dd><p>Add rules to the rule book</p>
<dl class="docutils">
<dt>Args:</dt>
<dd>rule_defs (dict): rule definitions dictionary</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="google.cloud.security.scanner.audit.cloudsql_rules_engine.CloudSqlRuleBook.get_resource_rules">
<code class="descname">get_resource_rules</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/google/cloud/security/scanner/audit/cloudsql_rules_engine.html#CloudSqlRuleBook.get_resource_rules"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#google.cloud.security.scanner.audit.cloudsql_rules_engine.CloudSqlRuleBook.get_resource_rules" title="Permalink to this definition">¶</a></dt>
<dd><p>Get all the resource rules for (resource, RuleAppliesTo.*).</p>
<dl class="docutils">
<dt>Returns:</dt>
<dd>list: A list of ResourceRules.</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="google.cloud.security.scanner.audit.cloudsql_rules_engine.CloudSqlRulesEngine">
<em class="property">class </em><code class="descclassname">google.cloud.security.scanner.audit.cloudsql_rules_engine.</code><code class="descname">CloudSqlRulesEngine</code><span class="sig-paren">(</span><em>rules_file_path</em>, <em>snapshot_timestamp=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/google/cloud/security/scanner/audit/cloudsql_rules_engine.html#CloudSqlRulesEngine"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#google.cloud.security.scanner.audit.cloudsql_rules_engine.CloudSqlRulesEngine" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#google.cloud.security.scanner.audit.base_rules_engine.BaseRulesEngine" title="google.cloud.security.scanner.audit.base_rules_engine.BaseRulesEngine"><code class="xref py py-class docutils literal"><span class="pre">google.cloud.security.scanner.audit.base_rules_engine.BaseRulesEngine</span></code></a></p>
<p>Rules engine for CloudSQL acls</p>
<dl class="method">
<dt id="google.cloud.security.scanner.audit.cloudsql_rules_engine.CloudSqlRulesEngine.add_rules">
<code class="descname">add_rules</code><span class="sig-paren">(</span><em>rules</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/google/cloud/security/scanner/audit/cloudsql_rules_engine.html#CloudSqlRulesEngine.add_rules"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#google.cloud.security.scanner.audit.cloudsql_rules_engine.CloudSqlRulesEngine.add_rules" title="Permalink to this definition">¶</a></dt>
<dd><p>Add rules to the rule book.</p>
<dl class="docutils">
<dt>Args:</dt>
<dd>rules (dict): rule definitions dictionary</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="google.cloud.security.scanner.audit.cloudsql_rules_engine.CloudSqlRulesEngine.build_rule_book">
<code class="descname">build_rule_book</code><span class="sig-paren">(</span><em>global_configs=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/google/cloud/security/scanner/audit/cloudsql_rules_engine.html#CloudSqlRulesEngine.build_rule_book"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#google.cloud.security.scanner.audit.cloudsql_rules_engine.CloudSqlRulesEngine.build_rule_book" title="Permalink to this definition">¶</a></dt>
<dd><p>Build CloudSQLRuleBook from the rules definition file.</p>
<dl class="docutils">
<dt>Args:</dt>
<dd>global_configs (dict): Global configurations.</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="google.cloud.security.scanner.audit.cloudsql_rules_engine.CloudSqlRulesEngine.find_policy_violations">
<code class="descname">find_policy_violations</code><span class="sig-paren">(</span><em>cloudsql_acls</em>, <em>force_rebuild=False</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/google/cloud/security/scanner/audit/cloudsql_rules_engine.html#CloudSqlRulesEngine.find_policy_violations"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#google.cloud.security.scanner.audit.cloudsql_rules_engine.CloudSqlRulesEngine.find_policy_violations" title="Permalink to this definition">¶</a></dt>
<dd><p>Determine whether CloudSQL acls violates rules.</p>
<dl class="docutils">
<dt>Args:</dt>
<dd><dl class="first last docutils">
<dt>cloudsql_acls (CloudsqlAccessControls): Object containing</dt>
<dd>ACL data</dd>
<dt>force_rebuild (bool): If True, rebuilds the rule book. This will</dt>
<dd>reload the rules definition file and add the rules to the book.</dd>
</dl>
</dd>
<dt>Returns:</dt>
<dd>generator: A generator of rule violations.</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="google.cloud.security.scanner.audit.cloudsql_rules_engine.Rule">
<em class="property">class </em><code class="descclassname">google.cloud.security.scanner.audit.cloudsql_rules_engine.</code><code class="descname">Rule</code><span class="sig-paren">(</span><em>rule_name</em>, <em>rule_index</em>, <em>rules</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/google/cloud/security/scanner/audit/cloudsql_rules_engine.html#Rule"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#google.cloud.security.scanner.audit.cloudsql_rules_engine.Rule" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal"><span class="pre">object</span></code></p>
<p>Rule properties from the rule definition file.
Also finds violations.</p>
<dl class="class">
<dt id="google.cloud.security.scanner.audit.cloudsql_rules_engine.Rule.RuleViolation">
<em class="property">class </em><code class="descname">RuleViolation</code><span class="sig-paren">(</span><em>resource_type</em>, <em>resource_id</em>, <em>rule_name</em>, <em>rule_index</em>, <em>violation_type</em>, <em>instance_name</em>, <em>authorized_networks</em>, <em>ssl_enabled</em><span class="sig-paren">)</span><a class="headerlink" href="#google.cloud.security.scanner.audit.cloudsql_rules_engine.Rule.RuleViolation" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal"><span class="pre">tuple</span></code></p>
<dl class="attribute">
<dt id="google.cloud.security.scanner.audit.cloudsql_rules_engine.Rule.RuleViolation.authorized_networks">
<code class="descname">authorized_networks</code><a class="headerlink" href="#google.cloud.security.scanner.audit.cloudsql_rules_engine.Rule.RuleViolation.authorized_networks" title="Permalink to this definition">¶</a></dt>
<dd><p>Alias for field number 6</p>
</dd></dl>

<dl class="attribute">
<dt id="google.cloud.security.scanner.audit.cloudsql_rules_engine.Rule.RuleViolation.instance_name">
<code class="descname">instance_name</code><a class="headerlink" href="#google.cloud.security.scanner.audit.cloudsql_rules_engine.Rule.RuleViolation.instance_name" title="Permalink to this definition">¶</a></dt>
<dd><p>Alias for field number 5</p>
</dd></dl>

<dl class="attribute">
<dt id="google.cloud.security.scanner.audit.cloudsql_rules_engine.Rule.RuleViolation.resource_id">
<code class="descname">resource_id</code><a class="headerlink" href="#google.cloud.security.scanner.audit.cloudsql_rules_engine.Rule.RuleViolation.resource_id" title="Permalink to this definition">¶</a></dt>
<dd><p>Alias for field number 1</p>
</dd></dl>

<dl class="attribute">
<dt id="google.cloud.security.scanner.audit.cloudsql_rules_engine.Rule.RuleViolation.resource_type">
<code class="descname">resource_type</code><a class="headerlink" href="#google.cloud.security.scanner.audit.cloudsql_rules_engine.Rule.RuleViolation.resource_type" title="Permalink to this definition">¶</a></dt>
<dd><p>Alias for field number 0</p>
</dd></dl>

<dl class="attribute">
<dt id="google.cloud.security.scanner.audit.cloudsql_rules_engine.Rule.RuleViolation.rule_index">
<code class="descname">rule_index</code><a class="headerlink" href="#google.cloud.security.scanner.audit.cloudsql_rules_engine.Rule.RuleViolation.rule_index" title="Permalink to this definition">¶</a></dt>
<dd><p>Alias for field number 3</p>
</dd></dl>

<dl class="attribute">
<dt id="google.cloud.security.scanner.audit.cloudsql_rules_engine.Rule.RuleViolation.rule_name">
<code class="descname">rule_name</code><a class="headerlink" href="#google.cloud.security.scanner.audit.cloudsql_rules_engine.Rule.RuleViolation.rule_name" title="Permalink to this definition">¶</a></dt>
<dd><p>Alias for field number 2</p>
</dd></dl>

<dl class="attribute">
<dt id="google.cloud.security.scanner.audit.cloudsql_rules_engine.Rule.RuleViolation.ssl_enabled">
<code class="descname">ssl_enabled</code><a class="headerlink" href="#google.cloud.security.scanner.audit.cloudsql_rules_engine.Rule.RuleViolation.ssl_enabled" title="Permalink to this definition">¶</a></dt>
<dd><p>Alias for field number 7</p>
</dd></dl>

<dl class="attribute">
<dt id="google.cloud.security.scanner.audit.cloudsql_rules_engine.Rule.RuleViolation.violation_type">
<code class="descname">violation_type</code><a class="headerlink" href="#google.cloud.security.scanner.audit.cloudsql_rules_engine.Rule.RuleViolation.violation_type" title="Permalink to this definition">¶</a></dt>
<dd><p>Alias for field number 4</p>
</dd></dl>

</dd></dl>

<dl class="method">
<dt id="google.cloud.security.scanner.audit.cloudsql_rules_engine.Rule.find_policy_violations">
<code class="descclassname">Rule.</code><code class="descname">find_policy_violations</code><span class="sig-paren">(</span><em>cloudsql_acl</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/google/cloud/security/scanner/audit/cloudsql_rules_engine.html#Rule.find_policy_violations"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#google.cloud.security.scanner.audit.cloudsql_rules_engine.Rule.find_policy_violations" title="Permalink to this definition">¶</a></dt>
<dd><p>Find CloudSQL policy acl violations in the rule book.</p>
<dl class="docutils">
<dt>Args:</dt>
<dd>cloudsql_acl (CloudsqlAccessControls): CloudSQL ACL resource</dd>
<dt>Yields:</dt>
<dd>namedtuple: Returns RuleViolation named tuple</dd>
</dl>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="module-google.cloud.security.scanner.audit.errors">
<span id="google-cloud-security-scanner-audit-errors-module"></span><h2>google.cloud.security.scanner.audit.errors module<a class="headerlink" href="#module-google.cloud.security.scanner.audit.errors" title="Permalink to this headline">¶</a></h2>
<p>Errors related to the audit module.</p>
<dl class="exception">
<dt id="google.cloud.security.scanner.audit.errors.Error">
<em class="property">exception </em><code class="descclassname">google.cloud.security.scanner.audit.errors.</code><code class="descname">Error</code><a class="reference internal" href="../_modules/google/cloud/security/scanner/audit/errors.html#Error"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#google.cloud.security.scanner.audit.errors.Error" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal"><span class="pre">exceptions.Exception</span></code></p>
<p>Base error class for the module.</p>
</dd></dl>

<dl class="exception">
<dt id="google.cloud.security.scanner.audit.errors.InvalidRuleDefinitionError">
<em class="property">exception </em><code class="descclassname">google.cloud.security.scanner.audit.errors.</code><code class="descname">InvalidRuleDefinitionError</code><a class="reference internal" href="../_modules/google/cloud/security/scanner/audit/errors.html#InvalidRuleDefinitionError"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#google.cloud.security.scanner.audit.errors.InvalidRuleDefinitionError" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#google.cloud.security.scanner.audit.errors.Error" title="google.cloud.security.scanner.audit.errors.Error"><code class="xref py py-class docutils literal"><span class="pre">google.cloud.security.scanner.audit.errors.Error</span></code></a></p>
<p>Error for problems with the rule file.</p>
</dd></dl>

<dl class="exception">
<dt id="google.cloud.security.scanner.audit.errors.InvalidRulesSchemaError">
<em class="property">exception </em><code class="descclassname">google.cloud.security.scanner.audit.errors.</code><code class="descname">InvalidRulesSchemaError</code><a class="reference internal" href="../_modules/google/cloud/security/scanner/audit/errors.html#InvalidRulesSchemaError"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#google.cloud.security.scanner.audit.errors.InvalidRulesSchemaError" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#google.cloud.security.scanner.audit.errors.Error" title="google.cloud.security.scanner.audit.errors.Error"><code class="xref py py-class docutils literal"><span class="pre">google.cloud.security.scanner.audit.errors.Error</span></code></a></p>
<p>Error for invalid rule schema.</p>
</dd></dl>

</div>
<div class="section" id="module-google.cloud.security.scanner.audit.firewall_rules_engine">
<span id="google-cloud-security-scanner-audit-firewall-rules-engine-module"></span><h2>google.cloud.security.scanner.audit.firewall_rules_engine module<a class="headerlink" href="#module-google.cloud.security.scanner.audit.firewall_rules_engine" title="Permalink to this headline">¶</a></h2>
<p>Rules engine for firewall rules.</p>
<dl class="exception">
<dt id="google.cloud.security.scanner.audit.firewall_rules_engine.DuplicateFirewallGroupError">
<em class="property">exception </em><code class="descclassname">google.cloud.security.scanner.audit.firewall_rules_engine.</code><code class="descname">DuplicateFirewallGroupError</code><a class="reference internal" href="../_modules/google/cloud/security/scanner/audit/firewall_rules_engine.html#DuplicateFirewallGroupError"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#google.cloud.security.scanner.audit.firewall_rules_engine.DuplicateFirewallGroupError" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#google.cloud.security.scanner.audit.firewall_rules_engine.Error" title="google.cloud.security.scanner.audit.firewall_rules_engine.Error"><code class="xref py py-class docutils literal"><span class="pre">google.cloud.security.scanner.audit.firewall_rules_engine.Error</span></code></a></p>
<p>Raised if group id is reused in the group definitions, must be unique.</p>
</dd></dl>

<dl class="exception">
<dt id="google.cloud.security.scanner.audit.firewall_rules_engine.DuplicateFirewallRuleError">
<em class="property">exception </em><code class="descclassname">google.cloud.security.scanner.audit.firewall_rules_engine.</code><code class="descname">DuplicateFirewallRuleError</code><a class="reference internal" href="../_modules/google/cloud/security/scanner/audit/firewall_rules_engine.html#DuplicateFirewallRuleError"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#google.cloud.security.scanner.audit.firewall_rules_engine.DuplicateFirewallRuleError" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#google.cloud.security.scanner.audit.firewall_rules_engine.Error" title="google.cloud.security.scanner.audit.firewall_rules_engine.Error"><code class="xref py py-class docutils literal"><span class="pre">google.cloud.security.scanner.audit.firewall_rules_engine.Error</span></code></a></p>
<p>Raised if a rule id is reused in the rule definitions, must be unique.</p>
</dd></dl>

<dl class="exception">
<dt id="google.cloud.security.scanner.audit.firewall_rules_engine.Error">
<em class="property">exception </em><code class="descclassname">google.cloud.security.scanner.audit.firewall_rules_engine.</code><code class="descname">Error</code><a class="reference internal" href="../_modules/google/cloud/security/scanner/audit/firewall_rules_engine.html#Error"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#google.cloud.security.scanner.audit.firewall_rules_engine.Error" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal"><span class="pre">exceptions.Exception</span></code></p>
<p>Base error class for the module.</p>
</dd></dl>

<dl class="class">
<dt id="google.cloud.security.scanner.audit.firewall_rules_engine.FirewallRulesEngine">
<em class="property">class </em><code class="descclassname">google.cloud.security.scanner.audit.firewall_rules_engine.</code><code class="descname">FirewallRulesEngine</code><span class="sig-paren">(</span><em>rules_file_path</em>, <em>snapshot_timestamp=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/google/cloud/security/scanner/audit/firewall_rules_engine.html#FirewallRulesEngine"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#google.cloud.security.scanner.audit.firewall_rules_engine.FirewallRulesEngine" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#google.cloud.security.scanner.audit.base_rules_engine.BaseRulesEngine" title="google.cloud.security.scanner.audit.base_rules_engine.BaseRulesEngine"><code class="xref py py-class docutils literal"><span class="pre">google.cloud.security.scanner.audit.base_rules_engine.BaseRulesEngine</span></code></a></p>
<p>Rules engine for firewall resources.</p>
<dl class="method">
<dt id="google.cloud.security.scanner.audit.firewall_rules_engine.FirewallRulesEngine.build_rule_book">
<code class="descname">build_rule_book</code><span class="sig-paren">(</span><em>global_configs</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/google/cloud/security/scanner/audit/firewall_rules_engine.html#FirewallRulesEngine.build_rule_book"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#google.cloud.security.scanner.audit.firewall_rules_engine.FirewallRulesEngine.build_rule_book" title="Permalink to this definition">¶</a></dt>
<dd><p>Build RuleBook from the rule definition file.</p>
<dl class="docutils">
<dt>Args:</dt>
<dd>global_configs (dict): Global configurations.</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="google.cloud.security.scanner.audit.firewall_rules_engine.FirewallRulesEngine.find_policy_violations">
<code class="descname">find_policy_violations</code><span class="sig-paren">(</span><em>resource</em>, <em>policy</em>, <em>force_rebuild=False</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/google/cloud/security/scanner/audit/firewall_rules_engine.html#FirewallRulesEngine.find_policy_violations"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#google.cloud.security.scanner.audit.firewall_rules_engine.FirewallRulesEngine.find_policy_violations" title="Permalink to this definition">¶</a></dt>
<dd><p>Determine whether policy violates rules.</p>
<dl class="docutils">
<dt>Args:</dt>
<dd><p class="first">resource (Resource): The resource that the policy belongs to.
policy (dict): The policy to compare against the rules.
force_rebuild (bool): If True, rebuilds the rule book.</p>
<blockquote class="last">
<div>This will reload the rules definition file and add the rules to the
book.</div></blockquote>
</dd>
<dt>Returns:</dt>
<dd>list: A list of the rule violations.</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="exception">
<dt id="google.cloud.security.scanner.audit.firewall_rules_engine.GroupDoesntExistError">
<em class="property">exception </em><code class="descclassname">google.cloud.security.scanner.audit.firewall_rules_engine.</code><code class="descname">GroupDoesntExistError</code><a class="reference internal" href="../_modules/google/cloud/security/scanner/audit/firewall_rules_engine.html#GroupDoesntExistError"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#google.cloud.security.scanner.audit.firewall_rules_engine.GroupDoesntExistError" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#google.cloud.security.scanner.audit.firewall_rules_engine.Error" title="google.cloud.security.scanner.audit.firewall_rules_engine.Error"><code class="xref py py-class docutils literal"><span class="pre">google.cloud.security.scanner.audit.firewall_rules_engine.Error</span></code></a></p>
<p>Raised if an org policy tries to add a group that doesn&#8217;t exist.</p>
</dd></dl>

<dl class="exception">
<dt id="google.cloud.security.scanner.audit.firewall_rules_engine.InvalidGroupDefinition">
<em class="property">exception </em><code class="descclassname">google.cloud.security.scanner.audit.firewall_rules_engine.</code><code class="descname">InvalidGroupDefinition</code><a class="reference internal" href="../_modules/google/cloud/security/scanner/audit/firewall_rules_engine.html#InvalidGroupDefinition"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#google.cloud.security.scanner.audit.firewall_rules_engine.InvalidGroupDefinition" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#google.cloud.security.scanner.audit.firewall_rules_engine.Error" title="google.cloud.security.scanner.audit.firewall_rules_engine.Error"><code class="xref py py-class docutils literal"><span class="pre">google.cloud.security.scanner.audit.firewall_rules_engine.Error</span></code></a></p>
<p>Raised if a group definition is invalid.</p>
</dd></dl>

<dl class="exception">
<dt id="google.cloud.security.scanner.audit.firewall_rules_engine.InvalidOrgDefinition">
<em class="property">exception </em><code class="descclassname">google.cloud.security.scanner.audit.firewall_rules_engine.</code><code class="descname">InvalidOrgDefinition</code><a class="reference internal" href="../_modules/google/cloud/security/scanner/audit/firewall_rules_engine.html#InvalidOrgDefinition"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#google.cloud.security.scanner.audit.firewall_rules_engine.InvalidOrgDefinition" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#google.cloud.security.scanner.audit.firewall_rules_engine.Error" title="google.cloud.security.scanner.audit.firewall_rules_engine.Error"><code class="xref py py-class docutils literal"><span class="pre">google.cloud.security.scanner.audit.firewall_rules_engine.Error</span></code></a></p>
<p>Raised if a org definition is invalid.</p>
</dd></dl>

<dl class="exception">
<dt id="google.cloud.security.scanner.audit.firewall_rules_engine.InvalidRuleDefinition">
<em class="property">exception </em><code class="descclassname">google.cloud.security.scanner.audit.firewall_rules_engine.</code><code class="descname">InvalidRuleDefinition</code><a class="reference internal" href="../_modules/google/cloud/security/scanner/audit/firewall_rules_engine.html#InvalidRuleDefinition"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#google.cloud.security.scanner.audit.firewall_rules_engine.InvalidRuleDefinition" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#google.cloud.security.scanner.audit.firewall_rules_engine.Error" title="google.cloud.security.scanner.audit.firewall_rules_engine.Error"><code class="xref py py-class docutils literal"><span class="pre">google.cloud.security.scanner.audit.firewall_rules_engine.Error</span></code></a></p>
<p>Raised if a rule definition is invalid.</p>
</dd></dl>

<dl class="class">
<dt id="google.cloud.security.scanner.audit.firewall_rules_engine.Rule">
<em class="property">class </em><code class="descclassname">google.cloud.security.scanner.audit.firewall_rules_engine.</code><code class="descname">Rule</code><span class="sig-paren">(</span><em>rule_id=None</em>, <em>match_policies=None</em>, <em>verify_policies=None</em>, <em>mode='whitelist'</em>, <em>exact_match=True</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/google/cloud/security/scanner/audit/firewall_rules_engine.html#Rule"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#google.cloud.security.scanner.audit.firewall_rules_engine.Rule" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal"><span class="pre">object</span></code></p>
<p>Rule properties from the firewall rules definitions file.
Also finds violations.</p>
<dl class="attribute">
<dt id="google.cloud.security.scanner.audit.firewall_rules_engine.Rule.VALID_RULE_MODES">
<code class="descname">VALID_RULE_MODES</code><em class="property"> = frozenset(['blacklist', 'matches', 'whitelist', 'required'])</em><a class="headerlink" href="#google.cloud.security.scanner.audit.firewall_rules_engine.Rule.VALID_RULE_MODES" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="staticmethod">
<dt id="google.cloud.security.scanner.audit.firewall_rules_engine.Rule.create_rules">
<em class="property">static </em><code class="descname">create_rules</code><span class="sig-paren">(</span><em>policies</em>, <em>validate=False</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/google/cloud/security/scanner/audit/firewall_rules_engine.html#Rule.create_rules"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#google.cloud.security.scanner.audit.firewall_rules_engine.Rule.create_rules" title="Permalink to this definition">¶</a></dt>
<dd><p>Creates FirewallRules from policies.</p>
<dl class="docutils">
<dt>Args:</dt>
<dd><p class="first">policies (list): A list of policy dictionaries.
validate (bool): Whether to validate that this is a valid firewall</p>
<blockquote class="last">
<div>rule (one that can be passed to the API).</div></blockquote>
</dd>
<dt>Returns:</dt>
<dd>list: A list of FirewallRule.</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="google.cloud.security.scanner.audit.firewall_rules_engine.Rule.find_policy_violations">
<code class="descname">find_policy_violations</code><span class="sig-paren">(</span><em>firewall_policies</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/google/cloud/security/scanner/audit/firewall_rules_engine.html#Rule.find_policy_violations"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#google.cloud.security.scanner.audit.firewall_rules_engine.Rule.find_policy_violations" title="Permalink to this definition">¶</a></dt>
<dd><p>Finds policy violations in a list of firewall policies.</p>
<dl class="docutils">
<dt>Args:</dt>
<dd>firewall_policies (list): A list of FirewallRule.</dd>
<dt>Returns:</dt>
<dd>iterable: A generator of RuleViolations.</dd>
</dl>
</dd></dl>

<dl class="classmethod">
<dt id="google.cloud.security.scanner.audit.firewall_rules_engine.Rule.from_config">
<em class="property">classmethod </em><code class="descname">from_config</code><span class="sig-paren">(</span><em>rule_def</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/google/cloud/security/scanner/audit/firewall_rules_engine.html#Rule.from_config"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#google.cloud.security.scanner.audit.firewall_rules_engine.Rule.from_config" title="Permalink to this definition">¶</a></dt>
<dd><p>Creates a Rule from a config file.</p>
<dl class="docutils">
<dt>Args:</dt>
<dd>rule_def (dict): A dictionary rule definition parsed from YAML config.</dd>
<dt>Returns:</dt>
<dd>Rule: A rule created from the rule definition.</dd>
<dt>Raises:</dt>
<dd>InvalidRuleDefinition: If rule is missing required fields.</dd>
</dl>
</dd></dl>

<dl class="attribute">
<dt id="google.cloud.security.scanner.audit.firewall_rules_engine.Rule.match_rules">
<code class="descname">match_rules</code><a class="headerlink" href="#google.cloud.security.scanner.audit.firewall_rules_engine.Rule.match_rules" title="Permalink to this definition">¶</a></dt>
<dd><p>The FirewallRules used to filter policies.</p>
<dl class="docutils">
<dt>Returns:</dt>
<dd>list: A list of FirewallRule.</dd>
</dl>
</dd></dl>

<dl class="attribute">
<dt id="google.cloud.security.scanner.audit.firewall_rules_engine.Rule.verify_rules">
<code class="descname">verify_rules</code><a class="headerlink" href="#google.cloud.security.scanner.audit.firewall_rules_engine.Rule.verify_rules" title="Permalink to this definition">¶</a></dt>
<dd><p>The FirewallRules used to check policies.</p>
<dl class="docutils">
<dt>Returns:</dt>
<dd>list: A list of FirewallRule.</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="google.cloud.security.scanner.audit.firewall_rules_engine.RuleBook">
<em class="property">class </em><code class="descclassname">google.cloud.security.scanner.audit.firewall_rules_engine.</code><code class="descname">RuleBook</code><span class="sig-paren">(</span><em>global_configs</em>, <em>rule_defs=None</em>, <em>snapshot_timestamp=None</em>, <em>group_defs=None</em>, <em>org_policy=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/google/cloud/security/scanner/audit/firewall_rules_engine.html#RuleBook"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#google.cloud.security.scanner.audit.firewall_rules_engine.RuleBook" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#google.cloud.security.scanner.audit.base_rules_engine.BaseRuleBook" title="google.cloud.security.scanner.audit.base_rules_engine.BaseRuleBook"><code class="xref py py-class docutils literal"><span class="pre">google.cloud.security.scanner.audit.base_rules_engine.BaseRuleBook</span></code></a></p>
<p>The RuleBook for firewall auditing.</p>
<p>Rules from the rules definition file are parsed and then the hierarchy and
enforcement points are parsed. Rules then are assessed at the first
applicable point in the ancestory tree that has rules.</p>
<p>Sample org structure:</p>
<blockquote>
<div><blockquote>
<div><blockquote>
<div>org 1234</div></blockquote>
<p>/                  f-1       p-c</p>
</div></blockquote>
<p>/         p-a  p-b</p>
</div></blockquote>
<p>Rules can be applied at any node above. When a policy is being audited,
it the rulebook will start at the lowest level (the project) and will
walk up the hierarchy until it reaches the first instance with rules and
these are the only rules that are checked.</p>
<dl class="method">
<dt id="google.cloud.security.scanner.audit.firewall_rules_engine.RuleBook.add_org_policy">
<code class="descname">add_org_policy</code><span class="sig-paren">(</span><em>org_def</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/google/cloud/security/scanner/audit/firewall_rules_engine.html#RuleBook.add_org_policy"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#google.cloud.security.scanner.audit.firewall_rules_engine.RuleBook.add_org_policy" title="Permalink to this definition">¶</a></dt>
<dd><p>Creates org policy and rule mapping.</p>
<p>Sample org structure:</p>
<blockquote>
<div><blockquote>
<div><blockquote>
<div>org 1234</div></blockquote>
<p>/                      f-1       p-c</p>
</div></blockquote>
<p>/             p-a  p-b</p>
</div></blockquote>
<p>Rules can be applied at any node above. When a policy is being audited,
it the rulebook will start at the lowest level (the project) and will
walk up the hierarchy until it reaches the first instance with rules and
these are the only rules that are checked.</p>
<dl class="docutils">
<dt>Args:</dt>
<dd>org_def (dict): A dictionary of resource ids and enforced rules.</dd>
<dt>Raises:</dt>
<dd><dl class="first docutils">
<dt>RuleDoesntExistError: Raised if a rule included in the group does not</dt>
<dd>exist.</dd>
<dt>GroupDoesntExistError: Raised if a group included in an org policy</dt>
<dd>does not exist.</dd>
</dl>
<p class="last">InvalidOrgDefinition: Raised if org policy doesn&#8217;t have resources.</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="google.cloud.security.scanner.audit.firewall_rules_engine.RuleBook.add_rule">
<code class="descname">add_rule</code><span class="sig-paren">(</span><em>rule_def</em>, <em>rule_index</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/google/cloud/security/scanner/audit/firewall_rules_engine.html#RuleBook.add_rule"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#google.cloud.security.scanner.audit.firewall_rules_engine.RuleBook.add_rule" title="Permalink to this definition">¶</a></dt>
<dd><p>Adds a rule to the rule book.</p>
<dl class="docutils">
<dt>Args:</dt>
<dd>rule_def (Rule): A Rule used to check for violations.
rule_index (int): Used for logs.</dd>
<dt>Raises:</dt>
<dd>DuplicateFirewallRuleError: When the rule by the same name exists.</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="google.cloud.security.scanner.audit.firewall_rules_engine.RuleBook.add_rule_groups">
<code class="descname">add_rule_groups</code><span class="sig-paren">(</span><em>group_defs</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/google/cloud/security/scanner/audit/firewall_rules_engine.html#RuleBook.add_rule_groups"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#google.cloud.security.scanner.audit.firewall_rules_engine.RuleBook.add_rule_groups" title="Permalink to this definition">¶</a></dt>
<dd><p>Creates group to rule matching.</p>
<dl class="docutils">
<dt>Args:</dt>
<dd><dl class="first last docutils">
<dt>group_defs (dict): A dictionary with a group id and a list of rule ids</dt>
<dd>that will be included by including this group in a policy.</dd>
</dl>
</dd>
<dt>Raises:</dt>
<dd><p class="first">DuplicateFirewallGroupError: Raised if the group id already exists.
RuleDoesntExistError: Raised if a rule included in the group does not</p>
<blockquote>
<div>exist.</div></blockquote>
<p class="last">InvalidGroupDefinition: Raised if a group definition is invalid.</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="google.cloud.security.scanner.audit.firewall_rules_engine.RuleBook.add_rules">
<code class="descname">add_rules</code><span class="sig-paren">(</span><em>rule_defs</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/google/cloud/security/scanner/audit/firewall_rules_engine.html#RuleBook.add_rules"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#google.cloud.security.scanner.audit.firewall_rules_engine.RuleBook.add_rules" title="Permalink to this definition">¶</a></dt>
<dd><p>Adds rules to rule book.</p>
<dl class="docutils">
<dt>Args:</dt>
<dd>rule_defs (list): Rule definition dictionaries from yaml config file.</dd>
<dt>Raises:</dt>
<dd><dl class="first last docutils">
<dt>InvalidRuleDefinition: If the rule is missing required fields or the</dt>
<dd>fields have invalid values.</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="google.cloud.security.scanner.audit.firewall_rules_engine.RuleBook.find_violations">
<code class="descname">find_violations</code><span class="sig-paren">(</span><em>resource</em>, <em>policies</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/google/cloud/security/scanner/audit/firewall_rules_engine.html#RuleBook.find_violations"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#google.cloud.security.scanner.audit.firewall_rules_engine.RuleBook.find_violations" title="Permalink to this definition">¶</a></dt>
<dd><p>Find policy binding violations in the rule book.</p>
<dl class="docutils">
<dt>Args:</dt>
<dd><dl class="first docutils">
<dt>resource (Resource): The GCP resource associated with the</dt>
<dd>policy binding.
This is where we start looking for rule violations and
we move up the resource hierarchy (if permitted by the
resource&#8217;s &#8220;inherit_from_parents&#8221; property).</dd>
</dl>
<p class="last">policies(list): A list of FirewallRule policies.</p>
</dd>
<dt>Returns:</dt>
<dd>iterable: A generator of the rule violations.</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="exception">
<dt id="google.cloud.security.scanner.audit.firewall_rules_engine.RuleDoesntExistError">
<em class="property">exception </em><code class="descclassname">google.cloud.security.scanner.audit.firewall_rules_engine.</code><code class="descname">RuleDoesntExistError</code><a class="reference internal" href="../_modules/google/cloud/security/scanner/audit/firewall_rules_engine.html#RuleDoesntExistError"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#google.cloud.security.scanner.audit.firewall_rules_engine.RuleDoesntExistError" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#google.cloud.security.scanner.audit.firewall_rules_engine.Error" title="google.cloud.security.scanner.audit.firewall_rules_engine.Error"><code class="xref py py-class docutils literal"><span class="pre">google.cloud.security.scanner.audit.firewall_rules_engine.Error</span></code></a></p>
<p>Raised if a rule group tries to add a rule that doesn&#8217;t exist.</p>
</dd></dl>

<dl class="class">
<dt id="google.cloud.security.scanner.audit.firewall_rules_engine.RuleViolation">
<em class="property">class </em><code class="descclassname">google.cloud.security.scanner.audit.firewall_rules_engine.</code><code class="descname">RuleViolation</code><span class="sig-paren">(</span><em>resource_type</em>, <em>resource_id</em>, <em>rule_id</em>, <em>violation_type</em>, <em>policy_names</em>, <em>recommended_actions</em><span class="sig-paren">)</span><a class="headerlink" href="#google.cloud.security.scanner.audit.firewall_rules_engine.RuleViolation" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal"><span class="pre">tuple</span></code></p>
<dl class="attribute">
<dt id="google.cloud.security.scanner.audit.firewall_rules_engine.RuleViolation.policy_names">
<code class="descname">policy_names</code><a class="headerlink" href="#google.cloud.security.scanner.audit.firewall_rules_engine.RuleViolation.policy_names" title="Permalink to this definition">¶</a></dt>
<dd><p>Alias for field number 4</p>
</dd></dl>

<dl class="attribute">
<dt id="google.cloud.security.scanner.audit.firewall_rules_engine.RuleViolation.recommended_actions">
<code class="descname">recommended_actions</code><a class="headerlink" href="#google.cloud.security.scanner.audit.firewall_rules_engine.RuleViolation.recommended_actions" title="Permalink to this definition">¶</a></dt>
<dd><p>Alias for field number 5</p>
</dd></dl>

<dl class="attribute">
<dt id="google.cloud.security.scanner.audit.firewall_rules_engine.RuleViolation.resource_id">
<code class="descname">resource_id</code><a class="headerlink" href="#google.cloud.security.scanner.audit.firewall_rules_engine.RuleViolation.resource_id" title="Permalink to this definition">¶</a></dt>
<dd><p>Alias for field number 1</p>
</dd></dl>

<dl class="attribute">
<dt id="google.cloud.security.scanner.audit.firewall_rules_engine.RuleViolation.resource_type">
<code class="descname">resource_type</code><a class="headerlink" href="#google.cloud.security.scanner.audit.firewall_rules_engine.RuleViolation.resource_type" title="Permalink to this definition">¶</a></dt>
<dd><p>Alias for field number 0</p>
</dd></dl>

<dl class="attribute">
<dt id="google.cloud.security.scanner.audit.firewall_rules_engine.RuleViolation.rule_id">
<code class="descname">rule_id</code><a class="headerlink" href="#google.cloud.security.scanner.audit.firewall_rules_engine.RuleViolation.rule_id" title="Permalink to this definition">¶</a></dt>
<dd><p>Alias for field number 2</p>
</dd></dl>

<dl class="attribute">
<dt id="google.cloud.security.scanner.audit.firewall_rules_engine.RuleViolation.violation_type">
<code class="descname">violation_type</code><a class="headerlink" href="#google.cloud.security.scanner.audit.firewall_rules_engine.RuleViolation.violation_type" title="Permalink to this definition">¶</a></dt>
<dd><p>Alias for field number 3</p>
</dd></dl>

</dd></dl>

<dl class="function">
<dt id="google.cloud.security.scanner.audit.firewall_rules_engine.is_blacklist_violation">
<code class="descclassname">google.cloud.security.scanner.audit.firewall_rules_engine.</code><code class="descname">is_blacklist_violation</code><span class="sig-paren">(</span><em>rules</em>, <em>policy</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/google/cloud/security/scanner/audit/firewall_rules_engine.html#is_blacklist_violation"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#google.cloud.security.scanner.audit.firewall_rules_engine.is_blacklist_violation" title="Permalink to this definition">¶</a></dt>
<dd><p>Checks if the policy is a superset of any not allowed by the rules.</p>
<dl class="docutils">
<dt>Args:</dt>
<dd>rules (list): A list of FirewallRule that the policy must be a subset of.
policy (FirweallRule): A FirewallRule.</dd>
<dt>Returns:</dt>
<dd>bool: If the policy is a superset of one of the blacklisted rules or not.</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="google.cloud.security.scanner.audit.firewall_rules_engine.is_rule_exists_violation">
<code class="descclassname">google.cloud.security.scanner.audit.firewall_rules_engine.</code><code class="descname">is_rule_exists_violation</code><span class="sig-paren">(</span><em>rule</em>, <em>policies</em>, <em>exact_match=True</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/google/cloud/security/scanner/audit/firewall_rules_engine.html#is_rule_exists_violation"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#google.cloud.security.scanner.audit.firewall_rules_engine.is_rule_exists_violation" title="Permalink to this definition">¶</a></dt>
<dd><p>Checks if the rule is the same as one of the policies.</p>
<dl class="docutils">
<dt>Args:</dt>
<dd>rule (FirweallRule): A FirewallRule.
policies (list): A list of FirewallRule that must have the rule.
exact_match (bool): Whether to match the rule exactly.</dd>
<dt>Returns:</dt>
<dd>bool: If the required rule is in the policies.</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="google.cloud.security.scanner.audit.firewall_rules_engine.is_whitelist_violation">
<code class="descclassname">google.cloud.security.scanner.audit.firewall_rules_engine.</code><code class="descname">is_whitelist_violation</code><span class="sig-paren">(</span><em>rules</em>, <em>policy</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/google/cloud/security/scanner/audit/firewall_rules_engine.html#is_whitelist_violation"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#google.cloud.security.scanner.audit.firewall_rules_engine.is_whitelist_violation" title="Permalink to this definition">¶</a></dt>
<dd><p>Checks if the policy is not a subset of those allowed by the rules.</p>
<dl class="docutils">
<dt>Args:</dt>
<dd>rules (list): A list of FirewallRule that the policy must be a subset of.
policy (FirweallRule): A FirewallRule.</dd>
<dt>Returns:</dt>
<dd>bool: If the policy is a subset of one of the allowed rules or not.</dd>
</dl>
</dd></dl>

</div>
<div class="section" id="module-google.cloud.security.scanner.audit.forwarding_rule_rules_engine">
<span id="google-cloud-security-scanner-audit-forwarding-rule-rules-engine-module"></span><h2>google.cloud.security.scanner.audit.forwarding_rule_rules_engine module<a class="headerlink" href="#module-google.cloud.security.scanner.audit.forwarding_rule_rules_engine" title="Permalink to this headline">¶</a></h2>
<p>Rules engine for forwarding rules engine</p>
<dl class="class">
<dt id="google.cloud.security.scanner.audit.forwarding_rule_rules_engine.ForwardingRuleRulesBook">
<em class="property">class </em><code class="descclassname">google.cloud.security.scanner.audit.forwarding_rule_rules_engine.</code><code class="descname">ForwardingRuleRulesBook</code><span class="sig-paren">(</span><em>rule_defs=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/google/cloud/security/scanner/audit/forwarding_rule_rules_engine.html#ForwardingRuleRulesBook"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#google.cloud.security.scanner.audit.forwarding_rule_rules_engine.ForwardingRuleRulesBook" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#google.cloud.security.scanner.audit.base_rules_engine.BaseRuleBook" title="google.cloud.security.scanner.audit.base_rules_engine.BaseRuleBook"><code class="xref py py-class docutils literal"><span class="pre">google.cloud.security.scanner.audit.base_rules_engine.BaseRuleBook</span></code></a></p>
<p>The RuleBook for forwarding rules resources.</p>
<dl class="method">
<dt id="google.cloud.security.scanner.audit.forwarding_rule_rules_engine.ForwardingRuleRulesBook.add_rule">
<code class="descname">add_rule</code><span class="sig-paren">(</span><em>rule_def</em>, <em>rule_index</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/google/cloud/security/scanner/audit/forwarding_rule_rules_engine.html#ForwardingRuleRulesBook.add_rule"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#google.cloud.security.scanner.audit.forwarding_rule_rules_engine.ForwardingRuleRulesBook.add_rule" title="Permalink to this definition">¶</a></dt>
<dd><p>Add a rule to the rule book.</p>
<dl class="docutils">
<dt>Args:</dt>
<dd><dl class="first last docutils">
<dt>rule_def (dict): A dictionary containing rule definition</dt>
<dd>properties.</dd>
<dt>rule_index (int): The index of the rule from the rule definitions.</dt>
<dd>Assigned automatically when the rule book is built.</dd>
</dl>
</dd>
<dt>Raises:</dt>
<dd>InvalidRulesSchemaError: if rule has format error</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="google.cloud.security.scanner.audit.forwarding_rule_rules_engine.ForwardingRuleRulesBook.add_rules">
<code class="descname">add_rules</code><span class="sig-paren">(</span><em>rule_defs</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/google/cloud/security/scanner/audit/forwarding_rule_rules_engine.html#ForwardingRuleRulesBook.add_rules"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#google.cloud.security.scanner.audit.forwarding_rule_rules_engine.ForwardingRuleRulesBook.add_rules" title="Permalink to this definition">¶</a></dt>
<dd><p>Add rules to the rule book</p>
<dl class="docutils">
<dt>Args:</dt>
<dd>rule_defs (dict): list of rules and their index number</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="google.cloud.security.scanner.audit.forwarding_rule_rules_engine.ForwardingRuleRulesBook.get_resource_rules">
<code class="descname">get_resource_rules</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/google/cloud/security/scanner/audit/forwarding_rule_rules_engine.html#ForwardingRuleRulesBook.get_resource_rules"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#google.cloud.security.scanner.audit.forwarding_rule_rules_engine.ForwardingRuleRulesBook.get_resource_rules" title="Permalink to this definition">¶</a></dt>
<dd><p>Get all the resource_rules as a list from the resource_rules_map</p>
<dl class="docutils">
<dt>Returns:</dt>
<dd>list: A list of ResourceRules.</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="google.cloud.security.scanner.audit.forwarding_rule_rules_engine.ForwardingRuleRulesEngine">
<em class="property">class </em><code class="descclassname">google.cloud.security.scanner.audit.forwarding_rule_rules_engine.</code><code class="descname">ForwardingRuleRulesEngine</code><span class="sig-paren">(</span><em>rules_file_path</em>, <em>snapshot_timestamp=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/google/cloud/security/scanner/audit/forwarding_rule_rules_engine.html#ForwardingRuleRulesEngine"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#google.cloud.security.scanner.audit.forwarding_rule_rules_engine.ForwardingRuleRulesEngine" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#google.cloud.security.scanner.audit.base_rules_engine.BaseRulesEngine" title="google.cloud.security.scanner.audit.base_rules_engine.BaseRulesEngine"><code class="xref py py-class docutils literal"><span class="pre">google.cloud.security.scanner.audit.base_rules_engine.BaseRulesEngine</span></code></a></p>
<p>Rules engine for forwarding rules</p>
<dl class="class">
<dt id="google.cloud.security.scanner.audit.forwarding_rule_rules_engine.ForwardingRuleRulesEngine.RuleViolation">
<em class="property">class </em><code class="descname">RuleViolation</code><span class="sig-paren">(</span><em>violation_type</em>, <em>target</em>, <em>rule_index</em>, <em>load_balancing_scheme</em>, <em>port_range</em>, <em>resource_type</em>, <em>port</em>, <em>ip_protocol</em>, <em>ip_address</em>, <em>resource_id</em><span class="sig-paren">)</span><a class="headerlink" href="#google.cloud.security.scanner.audit.forwarding_rule_rules_engine.ForwardingRuleRulesEngine.RuleViolation" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal"><span class="pre">tuple</span></code></p>
<dl class="attribute">
<dt id="google.cloud.security.scanner.audit.forwarding_rule_rules_engine.ForwardingRuleRulesEngine.RuleViolation.ip_address">
<code class="descname">ip_address</code><a class="headerlink" href="#google.cloud.security.scanner.audit.forwarding_rule_rules_engine.ForwardingRuleRulesEngine.RuleViolation.ip_address" title="Permalink to this definition">¶</a></dt>
<dd><p>Alias for field number 8</p>
</dd></dl>

<dl class="attribute">
<dt id="google.cloud.security.scanner.audit.forwarding_rule_rules_engine.ForwardingRuleRulesEngine.RuleViolation.ip_protocol">
<code class="descname">ip_protocol</code><a class="headerlink" href="#google.cloud.security.scanner.audit.forwarding_rule_rules_engine.ForwardingRuleRulesEngine.RuleViolation.ip_protocol" title="Permalink to this definition">¶</a></dt>
<dd><p>Alias for field number 7</p>
</dd></dl>

<dl class="attribute">
<dt id="google.cloud.security.scanner.audit.forwarding_rule_rules_engine.ForwardingRuleRulesEngine.RuleViolation.load_balancing_scheme">
<code class="descname">load_balancing_scheme</code><a class="headerlink" href="#google.cloud.security.scanner.audit.forwarding_rule_rules_engine.ForwardingRuleRulesEngine.RuleViolation.load_balancing_scheme" title="Permalink to this definition">¶</a></dt>
<dd><p>Alias for field number 3</p>
</dd></dl>

<dl class="attribute">
<dt id="google.cloud.security.scanner.audit.forwarding_rule_rules_engine.ForwardingRuleRulesEngine.RuleViolation.port">
<code class="descname">port</code><a class="headerlink" href="#google.cloud.security.scanner.audit.forwarding_rule_rules_engine.ForwardingRuleRulesEngine.RuleViolation.port" title="Permalink to this definition">¶</a></dt>
<dd><p>Alias for field number 6</p>
</dd></dl>

<dl class="attribute">
<dt id="google.cloud.security.scanner.audit.forwarding_rule_rules_engine.ForwardingRuleRulesEngine.RuleViolation.port_range">
<code class="descname">port_range</code><a class="headerlink" href="#google.cloud.security.scanner.audit.forwarding_rule_rules_engine.ForwardingRuleRulesEngine.RuleViolation.port_range" title="Permalink to this definition">¶</a></dt>
<dd><p>Alias for field number 4</p>
</dd></dl>

<dl class="attribute">
<dt id="google.cloud.security.scanner.audit.forwarding_rule_rules_engine.ForwardingRuleRulesEngine.RuleViolation.resource_id">
<code class="descname">resource_id</code><a class="headerlink" href="#google.cloud.security.scanner.audit.forwarding_rule_rules_engine.ForwardingRuleRulesEngine.RuleViolation.resource_id" title="Permalink to this definition">¶</a></dt>
<dd><p>Alias for field number 9</p>
</dd></dl>

<dl class="attribute">
<dt id="google.cloud.security.scanner.audit.forwarding_rule_rules_engine.ForwardingRuleRulesEngine.RuleViolation.resource_type">
<code class="descname">resource_type</code><a class="headerlink" href="#google.cloud.security.scanner.audit.forwarding_rule_rules_engine.ForwardingRuleRulesEngine.RuleViolation.resource_type" title="Permalink to this definition">¶</a></dt>
<dd><p>Alias for field number 5</p>
</dd></dl>

<dl class="attribute">
<dt id="google.cloud.security.scanner.audit.forwarding_rule_rules_engine.ForwardingRuleRulesEngine.RuleViolation.rule_index">
<code class="descname">rule_index</code><a class="headerlink" href="#google.cloud.security.scanner.audit.forwarding_rule_rules_engine.ForwardingRuleRulesEngine.RuleViolation.rule_index" title="Permalink to this definition">¶</a></dt>
<dd><p>Alias for field number 2</p>
</dd></dl>

<dl class="attribute">
<dt id="google.cloud.security.scanner.audit.forwarding_rule_rules_engine.ForwardingRuleRulesEngine.RuleViolation.target">
<code class="descname">target</code><a class="headerlink" href="#google.cloud.security.scanner.audit.forwarding_rule_rules_engine.ForwardingRuleRulesEngine.RuleViolation.target" title="Permalink to this definition">¶</a></dt>
<dd><p>Alias for field number 1</p>
</dd></dl>

<dl class="attribute">
<dt id="google.cloud.security.scanner.audit.forwarding_rule_rules_engine.ForwardingRuleRulesEngine.RuleViolation.violation_type">
<code class="descname">violation_type</code><a class="headerlink" href="#google.cloud.security.scanner.audit.forwarding_rule_rules_engine.ForwardingRuleRulesEngine.RuleViolation.violation_type" title="Permalink to this definition">¶</a></dt>
<dd><p>Alias for field number 0</p>
</dd></dl>

</dd></dl>

<dl class="method">
<dt id="google.cloud.security.scanner.audit.forwarding_rule_rules_engine.ForwardingRuleRulesEngine.add_rules">
<code class="descclassname">ForwardingRuleRulesEngine.</code><code class="descname">add_rules</code><span class="sig-paren">(</span><em>rules</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/google/cloud/security/scanner/audit/forwarding_rule_rules_engine.html#ForwardingRuleRulesEngine.add_rules"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#google.cloud.security.scanner.audit.forwarding_rule_rules_engine.ForwardingRuleRulesEngine.add_rules" title="Permalink to this definition">¶</a></dt>
<dd><p>Add rules to the rule book.</p>
<dl class="docutils">
<dt>Args:</dt>
<dd>rules (dict): rule from file to be added to book</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="google.cloud.security.scanner.audit.forwarding_rule_rules_engine.ForwardingRuleRulesEngine.build_rule_book">
<code class="descclassname">ForwardingRuleRulesEngine.</code><code class="descname">build_rule_book</code><span class="sig-paren">(</span><em>global_configs=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/google/cloud/security/scanner/audit/forwarding_rule_rules_engine.html#ForwardingRuleRulesEngine.build_rule_book"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#google.cloud.security.scanner.audit.forwarding_rule_rules_engine.ForwardingRuleRulesEngine.build_rule_book" title="Permalink to this definition">¶</a></dt>
<dd><p>Build forwarding rules rule book from the rules definition file.</p>
<dl class="docutils">
<dt>Args:</dt>
<dd>global_configs (dict): Global configurations.</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="google.cloud.security.scanner.audit.forwarding_rule_rules_engine.ForwardingRuleRulesEngine.find_policy_violations">
<code class="descclassname">ForwardingRuleRulesEngine.</code><code class="descname">find_policy_violations</code><span class="sig-paren">(</span><em>forwarding_rule</em>, <em>force_rebuild=False</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/google/cloud/security/scanner/audit/forwarding_rule_rules_engine.html#ForwardingRuleRulesEngine.find_policy_violations"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#google.cloud.security.scanner.audit.forwarding_rule_rules_engine.ForwardingRuleRulesEngine.find_policy_violations" title="Permalink to this definition">¶</a></dt>
<dd><p>Determine whether forwarding rule violates rules.</p>
<dl class="docutils">
<dt>Args:</dt>
<dd><dl class="first last docutils">
<dt>forwarding_rule (ForwardingRule): The one specific forwarding rule</dt>
<dd>to be matched against all white list rules</dd>
<dt>force_rebuild (bool): If True, rebuilds the rule book. This will</dt>
<dd>reload the rules definition file and add the rules to the book.</dd>
</dl>
</dd>
<dt>Returns:</dt>
<dd><dl class="first last docutils">
<dt>RuleViolation: A rule violation tuple with all data about the</dt>
<dd>forwarding rule that didnt pass a white list</dd>
</dl>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="google.cloud.security.scanner.audit.forwarding_rule_rules_engine.Rule">
<em class="property">class </em><code class="descclassname">google.cloud.security.scanner.audit.forwarding_rule_rules_engine.</code><code class="descname">Rule</code><span class="sig-paren">(</span><em>rule_name</em>, <em>rule_index</em>, <em>rules</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/google/cloud/security/scanner/audit/forwarding_rule_rules_engine.html#Rule"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#google.cloud.security.scanner.audit.forwarding_rule_rules_engine.Rule" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal"><span class="pre">object</span></code></p>
<p>Rule properties from the rule definition file.
Also finds violations.</p>
<dl class="method">
<dt id="google.cloud.security.scanner.audit.forwarding_rule_rules_engine.Rule.find_match">
<code class="descname">find_match</code><span class="sig-paren">(</span><em>forwarding_rule</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/google/cloud/security/scanner/audit/forwarding_rule_rules_engine.html#Rule.find_match"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#google.cloud.security.scanner.audit.forwarding_rule_rules_engine.Rule.find_match" title="Permalink to this definition">¶</a></dt>
<dd><p>Find if the passed in forwarding rule matches any in the rule book</p>
<dl class="docutils">
<dt>Args:</dt>
<dd>forwarding_rule (ForwardingRule): forwarding rule resource</dd>
<dt>Returns:</dt>
<dd><dl class="first last docutils">
<dt>bool: true if the forwarding rule matched at least 1 rule in the</dt>
<dd>rulebook</dd>
</dl>
</dd>
</dl>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="module-google.cloud.security.scanner.audit.iam_rules_engine">
<span id="google-cloud-security-scanner-audit-iam-rules-engine-module"></span><h2>google.cloud.security.scanner.audit.iam_rules_engine module<a class="headerlink" href="#module-google.cloud.security.scanner.audit.iam_rules_engine" title="Permalink to this headline">¶</a></h2>
<p>Rules engine for organizations, folders, and projects.</p>
<p>Builds the RuleBook (IamRuleBook) from the rule definitions (file either
stored locally or in GCS) and compares a policy against the RuleBook to
determine whether there are violations.</p>
<dl class="class">
<dt id="google.cloud.security.scanner.audit.iam_rules_engine.IamRuleBook">
<em class="property">class </em><code class="descclassname">google.cloud.security.scanner.audit.iam_rules_engine.</code><code class="descname">IamRuleBook</code><span class="sig-paren">(</span><em>global_configs</em>, <em>rule_defs=None</em>, <em>snapshot_timestamp=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/google/cloud/security/scanner/audit/iam_rules_engine.html#IamRuleBook"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#google.cloud.security.scanner.audit.iam_rules_engine.IamRuleBook" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#google.cloud.security.scanner.audit.base_rules_engine.BaseRuleBook" title="google.cloud.security.scanner.audit.base_rules_engine.BaseRuleBook"><code class="xref py py-class docutils literal"><span class="pre">google.cloud.security.scanner.audit.base_rules_engine.BaseRuleBook</span></code></a></p>
<p>The RuleBook for organization resources.</p>
<p>Rules from the rules definition file are parsed and placed into a
map, which associates the GCP resource with the particular rules
defined for it.</p>
<p>Sample rules (simplified):</p>
<p>mode: whitelist
Org 1234, bindings: roles/<a href="#id1"><span class="problematic" id="id2">*</span></a>, members: user:<a href="#id3"><span class="problematic" id="id4">*</span></a>&#64;company.com
Project p-a, bindings: roles/owner, members: user:pa-owner&#64;company.com
Project p-b, bindings: roles/owner, members: user:pb-owner&#64;company.com</p>
<p>Sample org structure:</p>
<blockquote>
<div><blockquote>
<div><blockquote>
<div>org 1234</div></blockquote>
<p>/                  f-1       p-c</p>
</div></blockquote>
<p>/         p-a  p-b</p>
</div></blockquote>
<p>The rule book will be structured as:</p>
<dl class="docutils">
<dt>{</dt>
<dd>Resource(org-1234): ResourceRule(org-1234, [ rules ... ]),
Resource(p-a): ResourceRule(p-a, [ rules ... ]),
Resource(p-a): ResourceRule(p-a, [ rules ... ])</dd>
</dl>
<p>}</p>
<dl class="method">
<dt id="google.cloud.security.scanner.audit.iam_rules_engine.IamRuleBook.add_rule">
<code class="descname">add_rule</code><span class="sig-paren">(</span><em>rule_def</em>, <em>rule_index</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/google/cloud/security/scanner/audit/iam_rules_engine.html#IamRuleBook.add_rule"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#google.cloud.security.scanner.audit.iam_rules_engine.IamRuleBook.add_rule" title="Permalink to this definition">¶</a></dt>
<dd><p>Add a rule to the rule book.</p>
<p>The rule supplied to this method is the dictionary parsed from
the rules definition file.</p>
<p>For example, this rule...</p>
<blockquote>
<div><p># rules yaml:
rules:</p>
<blockquote>
<div><ul>
<li><p class="first">name: a rule
mode: whitelist
resource:</p>
<blockquote>
<div><ul>
<li><p class="first">type: project
applies_to: self
resource_ids:</p>
<blockquote>
<div><ul class="simple">
<li>my-project-123</li>
</ul>
</div></blockquote>
</li>
</ul>
</div></blockquote>
<p>inherit_from_parents: true
bindings:</p>
<blockquote>
<div><ul>
<li><p class="first">role: roles/editor
members:</p>
<blockquote>
<div><ul class="simple">
<li>users:a&#64;b.com</li>
</ul>
</div></blockquote>
</li>
</ul>
</div></blockquote>
</li>
</ul>
</div></blockquote>
</div></blockquote>
<p>... gets parsed into:</p>
<blockquote>
<div><dl class="docutils">
<dt>{</dt>
<dd><p class="first">&#8216;name&#8217;: &#8216;a rule&#8217;,
&#8216;mode&#8217;: &#8216;whitelist&#8217;,
&#8216;resource&#8217;: {</p>
<blockquote>
<div>&#8216;type&#8217;: &#8216;project&#8217;,
&#8216;applies_to&#8217;: self,
&#8216;resource_ids&#8217;: [&#8216;my-project-id&#8217;]</div></blockquote>
<p>},
&#8216;inherit_from_parents&#8217;: true,
&#8216;bindings&#8217;: [</p>
<blockquote>
<div><dl class="docutils">
<dt>{</dt>
<dd>&#8216;role&#8217;: &#8216;roles/editor&#8217;,
&#8216;members&#8217;: [&#8216;users:a&#64;b.com&#8217;]</dd>
</dl>
<p>}</p>
</div></blockquote>
<p class="last">]</p>
</dd>
</dl>
<p>}</p>
</div></blockquote>
<dl class="docutils">
<dt>Args:</dt>
<dd><p class="first">rule_def (dict): Contains rule definition properties.
rule_index (int): The index of the rule from the rule definitions.</p>
<blockquote class="last">
<div>Assigned automatically when the rule book is built.</div></blockquote>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="google.cloud.security.scanner.audit.iam_rules_engine.IamRuleBook.add_rules">
<code class="descname">add_rules</code><span class="sig-paren">(</span><em>rule_defs</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/google/cloud/security/scanner/audit/iam_rules_engine.html#IamRuleBook.add_rules"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#google.cloud.security.scanner.audit.iam_rules_engine.IamRuleBook.add_rules" title="Permalink to this definition">¶</a></dt>
<dd><p>Add rules to the rule book.</p>
<dl class="docutils">
<dt>Args:</dt>
<dd>rule_defs (dict): Rules parsed from the rule definition file.</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="google.cloud.security.scanner.audit.iam_rules_engine.IamRuleBook.find_violations">
<code class="descname">find_violations</code><span class="sig-paren">(</span><em>resource</em>, <em>policy_bindings</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/google/cloud/security/scanner/audit/iam_rules_engine.html#IamRuleBook.find_violations"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#google.cloud.security.scanner.audit.iam_rules_engine.IamRuleBook.find_violations" title="Permalink to this definition">¶</a></dt>
<dd><p>Find policy binding violations in the rule book.</p>
<dl class="docutils">
<dt>Args:</dt>
<dd><dl class="first docutils">
<dt>resource (Resource): The GCP resource associated with the</dt>
<dd>policy binding.
This is where we start looking for rule violations and
we move up the resource hierarchy (if permitted by the
resource&#8217;s &#8220;inherit_from_parents&#8221; property).</dd>
</dl>
<p class="last">policy_bindings (list): A list of IamPolicyBindings.</p>
</dd>
<dt>Returns:</dt>
<dd>iterable: A generator of the rule violations.</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="google.cloud.security.scanner.audit.iam_rules_engine.IamRulesEngine">
<em class="property">class </em><code class="descclassname">google.cloud.security.scanner.audit.iam_rules_engine.</code><code class="descname">IamRulesEngine</code><span class="sig-paren">(</span><em>rules_file_path</em>, <em>snapshot_timestamp=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/google/cloud/security/scanner/audit/iam_rules_engine.html#IamRulesEngine"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#google.cloud.security.scanner.audit.iam_rules_engine.IamRulesEngine" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#google.cloud.security.scanner.audit.base_rules_engine.BaseRulesEngine" title="google.cloud.security.scanner.audit.base_rules_engine.BaseRulesEngine"><code class="xref py py-class docutils literal"><span class="pre">google.cloud.security.scanner.audit.base_rules_engine.BaseRulesEngine</span></code></a></p>
<p>Rules engine for org resources.</p>
<dl class="method">
<dt id="google.cloud.security.scanner.audit.iam_rules_engine.IamRulesEngine.add_rules">
<code class="descname">add_rules</code><span class="sig-paren">(</span><em>rules</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/google/cloud/security/scanner/audit/iam_rules_engine.html#IamRulesEngine.add_rules"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#google.cloud.security.scanner.audit.iam_rules_engine.IamRulesEngine.add_rules" title="Permalink to this definition">¶</a></dt>
<dd><p>Add rules to the rule book.</p>
<dl class="docutils">
<dt>Args:</dt>
<dd>rules (list): The list of rules to add to the book.</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="google.cloud.security.scanner.audit.iam_rules_engine.IamRulesEngine.build_rule_book">
<code class="descname">build_rule_book</code><span class="sig-paren">(</span><em>global_configs</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/google/cloud/security/scanner/audit/iam_rules_engine.html#IamRulesEngine.build_rule_book"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#google.cloud.security.scanner.audit.iam_rules_engine.IamRulesEngine.build_rule_book" title="Permalink to this definition">¶</a></dt>
<dd><p>Build IamRuleBook from the rules definition file.</p>
<dl class="docutils">
<dt>Args:</dt>
<dd>global_configs (dict): Global configurations.</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="google.cloud.security.scanner.audit.iam_rules_engine.IamRulesEngine.find_policy_violations">
<code class="descname">find_policy_violations</code><span class="sig-paren">(</span><em>resource</em>, <em>policy</em>, <em>force_rebuild=False</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/google/cloud/security/scanner/audit/iam_rules_engine.html#IamRulesEngine.find_policy_violations"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#google.cloud.security.scanner.audit.iam_rules_engine.IamRulesEngine.find_policy_violations" title="Permalink to this definition">¶</a></dt>
<dd><p>Determine whether policy violates rules.</p>
<dl class="docutils">
<dt>Args:</dt>
<dd><p class="first">resource (Resource): The resource that the policy belongs to.
policy (dict): The policy to compare against the rules.</p>
<blockquote>
<div>See <a class="reference external" href="https://cloud.google.com/iam/reference/rest/v1/Policy">https://cloud.google.com/iam/reference/rest/v1/Policy</a>.</div></blockquote>
<dl class="last docutils">
<dt>force_rebuild (bool): If True, rebuilds the rule book.</dt>
<dd>This will reload the rules definition file and add the
rules to the book.</dd>
</dl>
</dd>
<dt>Returns:</dt>
<dd>iterable: A generator of rule violations.</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="google.cloud.security.scanner.audit.iam_rules_engine.ResourceRules">
<em class="property">class </em><code class="descclassname">google.cloud.security.scanner.audit.iam_rules_engine.</code><code class="descname">ResourceRules</code><span class="sig-paren">(</span><em>resource=None</em>, <em>rules=None</em>, <em>applies_to='self'</em>, <em>inherit_from_parents=False</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/google/cloud/security/scanner/audit/iam_rules_engine.html#ResourceRules"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#google.cloud.security.scanner.audit.iam_rules_engine.ResourceRules" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal"><span class="pre">object</span></code></p>
<p>An association of a resource to rules.</p>
<dl class="method">
<dt id="google.cloud.security.scanner.audit.iam_rules_engine.ResourceRules.find_mismatches">
<code class="descname">find_mismatches</code><span class="sig-paren">(</span><em>resource</em>, <em>policy_bindings</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/google/cloud/security/scanner/audit/iam_rules_engine.html#ResourceRules.find_mismatches"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#google.cloud.security.scanner.audit.iam_rules_engine.ResourceRules.find_mismatches" title="Permalink to this definition">¶</a></dt>
<dd><p>Determine if the policy binding matches this rule&#8217;s criteria.</p>
<p>How the member matching operates:</p>
<ol class="arabic simple">
<li>Whitelist: policy members match at least one rule member</li>
<li>Blacklist: policy members must not match any rule members</li>
<li>Require: rule members must all be found in policy members</li>
</ol>
<dl class="docutils">
<dt>Args:</dt>
<dd><p class="first">resource (Resource): The resource that the policy belongs to.
policy_bindings (list): The list of IamPolicyBindings</p>
<blockquote class="last">
<div>to compare to this rule&#8217;s bindings.</div></blockquote>
</dd>
<dt>Returns:</dt>
<dd>iterable: The violations generator</dd>
</dl>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="module-google.cloud.security.scanner.audit.iap_rules_engine">
<span id="google-cloud-security-scanner-audit-iap-rules-engine-module"></span><h2>google.cloud.security.scanner.audit.iap_rules_engine module<a class="headerlink" href="#module-google.cloud.security.scanner.audit.iap_rules_engine" title="Permalink to this headline">¶</a></h2>
<p>Rules engine for IAP policies on backend services</p>
<dl class="class">
<dt id="google.cloud.security.scanner.audit.iap_rules_engine.IapRuleBook">
<em class="property">class </em><code class="descclassname">google.cloud.security.scanner.audit.iap_rules_engine.</code><code class="descname">IapRuleBook</code><span class="sig-paren">(</span><em>global_configs</em>, <em>rule_defs=None</em>, <em>snapshot_timestamp=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/google/cloud/security/scanner/audit/iap_rules_engine.html#IapRuleBook"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#google.cloud.security.scanner.audit.iap_rules_engine.IapRuleBook" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#google.cloud.security.scanner.audit.base_rules_engine.BaseRuleBook" title="google.cloud.security.scanner.audit.base_rules_engine.BaseRuleBook"><code class="xref py py-class docutils literal"><span class="pre">google.cloud.security.scanner.audit.base_rules_engine.BaseRuleBook</span></code></a></p>
<p>The RuleBook for enforcing IAP policy on backend service resources.</p>
<dl class="method">
<dt id="google.cloud.security.scanner.audit.iap_rules_engine.IapRuleBook.add_rule">
<code class="descname">add_rule</code><span class="sig-paren">(</span><em>rule_def</em>, <em>rule_index</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/google/cloud/security/scanner/audit/iap_rules_engine.html#IapRuleBook.add_rule"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#google.cloud.security.scanner.audit.iap_rules_engine.IapRuleBook.add_rule" title="Permalink to this definition">¶</a></dt>
<dd><p>Add a rule to the rule book.</p>
<dl class="docutils">
<dt>Args:</dt>
<dd><p class="first">rule_def (dict): rule definition properties
rule_index (int): index of the rule from the rule definitions,</p>
<blockquote class="last">
<div>assigned automatically when the rule book is built</div></blockquote>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="google.cloud.security.scanner.audit.iap_rules_engine.IapRuleBook.add_rules">
<code class="descname">add_rules</code><span class="sig-paren">(</span><em>rule_defs</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/google/cloud/security/scanner/audit/iap_rules_engine.html#IapRuleBook.add_rules"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#google.cloud.security.scanner.audit.iap_rules_engine.IapRuleBook.add_rules" title="Permalink to this definition">¶</a></dt>
<dd><p>Add rules to the rule book.</p>
<dl class="docutils">
<dt>Args:</dt>
<dd>rule_defs (list): rule definition property dicts</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="google.cloud.security.scanner.audit.iap_rules_engine.IapRuleBook.find_violations">
<code class="descname">find_violations</code><span class="sig-paren">(</span><em>iap_resource</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/google/cloud/security/scanner/audit/iap_rules_engine.html#IapRuleBook.find_violations"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#google.cloud.security.scanner.audit.iap_rules_engine.IapRuleBook.find_violations" title="Permalink to this definition">¶</a></dt>
<dd><p>Find violations in the rule book.</p>
<dl class="docutils">
<dt>Args:</dt>
<dd>iap_resource (IapResource): IAP data</dd>
<dt>Returns:</dt>
<dd>list: RuleViolation</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="google.cloud.security.scanner.audit.iap_rules_engine.IapRuleBook.get_resource_rules">
<code class="descname">get_resource_rules</code><span class="sig-paren">(</span><em>resource</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/google/cloud/security/scanner/audit/iap_rules_engine.html#IapRuleBook.get_resource_rules"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#google.cloud.security.scanner.audit.iap_rules_engine.IapRuleBook.get_resource_rules" title="Permalink to this definition">¶</a></dt>
<dd><p>Get all the resource rules for (resource, RuleAppliesTo.*).</p>
<dl class="docutils">
<dt>Args:</dt>
<dd>resource (Resource): The gcp_type Resource find in the map.</dd>
<dt>Returns:</dt>
<dd>list: ResourceRules</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="google.cloud.security.scanner.audit.iap_rules_engine.IapRulesEngine">
<em class="property">class </em><code class="descclassname">google.cloud.security.scanner.audit.iap_rules_engine.</code><code class="descname">IapRulesEngine</code><span class="sig-paren">(</span><em>rules_file_path</em>, <em>snapshot_timestamp=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/google/cloud/security/scanner/audit/iap_rules_engine.html#IapRulesEngine"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#google.cloud.security.scanner.audit.iap_rules_engine.IapRulesEngine" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#google.cloud.security.scanner.audit.base_rules_engine.BaseRulesEngine" title="google.cloud.security.scanner.audit.base_rules_engine.BaseRulesEngine"><code class="xref py py-class docutils literal"><span class="pre">google.cloud.security.scanner.audit.base_rules_engine.BaseRulesEngine</span></code></a></p>
<p>Rules engine for applying IAP policies to backend services</p>
<dl class="method">
<dt id="google.cloud.security.scanner.audit.iap_rules_engine.IapRulesEngine.add_rules">
<code class="descname">add_rules</code><span class="sig-paren">(</span><em>rules</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/google/cloud/security/scanner/audit/iap_rules_engine.html#IapRulesEngine.add_rules"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#google.cloud.security.scanner.audit.iap_rules_engine.IapRulesEngine.add_rules" title="Permalink to this definition">¶</a></dt>
<dd><p>Add rules to the rule book.</p>
<dl class="docutils">
<dt>Args:</dt>
<dd>rules (list): dicts defining the rules to add</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="google.cloud.security.scanner.audit.iap_rules_engine.IapRulesEngine.build_rule_book">
<code class="descname">build_rule_book</code><span class="sig-paren">(</span><em>global_configs</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/google/cloud/security/scanner/audit/iap_rules_engine.html#IapRulesEngine.build_rule_book"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#google.cloud.security.scanner.audit.iap_rules_engine.IapRulesEngine.build_rule_book" title="Permalink to this definition">¶</a></dt>
<dd><p>Build IapRuleBook from the rules definition file.</p>
<dl class="docutils">
<dt>Args:</dt>
<dd>global_configs (dict): Global configurations.</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="google.cloud.security.scanner.audit.iap_rules_engine.IapRulesEngine.find_violations">
<code class="descname">find_violations</code><span class="sig-paren">(</span><em>iap_resource</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/google/cloud/security/scanner/audit/iap_rules_engine.html#IapRulesEngine.find_violations"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#google.cloud.security.scanner.audit.iap_rules_engine.IapRulesEngine.find_violations" title="Permalink to this definition">¶</a></dt>
<dd><p>Determine whether IAP-related settings violate rules.</p>
<dl class="docutils">
<dt>Args:</dt>
<dd>iap_resource (IapResource): IAP resource data</dd>
<dt>Returns:</dt>
<dd>list: RuleViolation</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="google.cloud.security.scanner.audit.iap_rules_engine.ResourceRules">
<em class="property">class </em><code class="descclassname">google.cloud.security.scanner.audit.iap_rules_engine.</code><code class="descname">ResourceRules</code><span class="sig-paren">(</span><em>resource=None</em>, <em>rules=None</em>, <em>applies_to='self'</em>, <em>inherit_from_parents=False</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/google/cloud/security/scanner/audit/iap_rules_engine.html#ResourceRules"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#google.cloud.security.scanner.audit.iap_rules_engine.ResourceRules" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal"><span class="pre">object</span></code></p>
<p>An association of a resource to rules.</p>
<dl class="method">
<dt id="google.cloud.security.scanner.audit.iap_rules_engine.ResourceRules.find_mismatches">
<code class="descname">find_mismatches</code><span class="sig-paren">(</span><em>resource</em>, <em>iap_resource</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/google/cloud/security/scanner/audit/iap_rules_engine.html#ResourceRules.find_mismatches"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#google.cloud.security.scanner.audit.iap_rules_engine.ResourceRules.find_mismatches" title="Permalink to this definition">¶</a></dt>
<dd><p>Determine if the policy binding matches this rule&#8217;s criteria.</p>
<dl class="docutils">
<dt>Args:</dt>
<dd>resource (Resource): Resource to evaluate
iap_resource (IapResource): IAP data</dd>
<dt>Returns:</dt>
<dd>list: RuleViolation</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="google.cloud.security.scanner.audit.iap_rules_engine.Rule">
<em class="property">class </em><code class="descclassname">google.cloud.security.scanner.audit.iap_rules_engine.</code><code class="descname">Rule</code><span class="sig-paren">(</span><em>rule_name</em>, <em>rule_index</em>, <em>allowed_alternate_services</em>, <em>allowed_direct_access_sources</em>, <em>allowed_iap_enabled</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/google/cloud/security/scanner/audit/iap_rules_engine.html#Rule"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#google.cloud.security.scanner.audit.iap_rules_engine.Rule" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal"><span class="pre">object</span></code></p>
<p>Rule properties from the rule definition file.</p>
<p>Also finds violations.</p>
<dl class="method">
<dt id="google.cloud.security.scanner.audit.iap_rules_engine.Rule.find_mismatches">
<code class="descname">find_mismatches</code><span class="sig-paren">(</span><em>resource</em>, <em>iap_resource</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/google/cloud/security/scanner/audit/iap_rules_engine.html#Rule.find_mismatches"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#google.cloud.security.scanner.audit.iap_rules_engine.Rule.find_mismatches" title="Permalink to this definition">¶</a></dt>
<dd><p>Find IAP policy violations in the rule book.</p>
<dl class="docutils">
<dt>Args:</dt>
<dd>resource (Resource): resource to inspect
iap_resource (IapResource): IAP data</dd>
<dt>Returns:</dt>
<dd>RuleViolation: IAP violations</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="google.cloud.security.scanner.audit.iap_rules_engine.RuleViolation">
<em class="property">class </em><code class="descclassname">google.cloud.security.scanner.audit.iap_rules_engine.</code><code class="descname">RuleViolation</code><span class="sig-paren">(</span><em>resource_type</em>, <em>resource_id</em>, <em>resource_name</em>, <em>rule_name</em>, <em>rule_index</em>, <em>violation_type</em>, <em>alternate_services_violations</em>, <em>iap_enabled_violation</em>, <em>direct_access_sources_violations</em><span class="sig-paren">)</span><a class="headerlink" href="#google.cloud.security.scanner.audit.iap_rules_engine.RuleViolation" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal"><span class="pre">tuple</span></code></p>
<dl class="attribute">
<dt id="google.cloud.security.scanner.audit.iap_rules_engine.RuleViolation.alternate_services_violations">
<code class="descname">alternate_services_violations</code><a class="headerlink" href="#google.cloud.security.scanner.audit.iap_rules_engine.RuleViolation.alternate_services_violations" title="Permalink to this definition">¶</a></dt>
<dd><p>Alias for field number 6</p>
</dd></dl>

<dl class="attribute">
<dt id="google.cloud.security.scanner.audit.iap_rules_engine.RuleViolation.direct_access_sources_violations">
<code class="descname">direct_access_sources_violations</code><a class="headerlink" href="#google.cloud.security.scanner.audit.iap_rules_engine.RuleViolation.direct_access_sources_violations" title="Permalink to this definition">¶</a></dt>
<dd><p>Alias for field number 8</p>
</dd></dl>

<dl class="attribute">
<dt id="google.cloud.security.scanner.audit.iap_rules_engine.RuleViolation.iap_enabled_violation">
<code class="descname">iap_enabled_violation</code><a class="headerlink" href="#google.cloud.security.scanner.audit.iap_rules_engine.RuleViolation.iap_enabled_violation" title="Permalink to this definition">¶</a></dt>
<dd><p>Alias for field number 7</p>
</dd></dl>

<dl class="attribute">
<dt id="google.cloud.security.scanner.audit.iap_rules_engine.RuleViolation.resource_id">
<code class="descname">resource_id</code><a class="headerlink" href="#google.cloud.security.scanner.audit.iap_rules_engine.RuleViolation.resource_id" title="Permalink to this definition">¶</a></dt>
<dd><p>Alias for field number 1</p>
</dd></dl>

<dl class="attribute">
<dt id="google.cloud.security.scanner.audit.iap_rules_engine.RuleViolation.resource_name">
<code class="descname">resource_name</code><a class="headerlink" href="#google.cloud.security.scanner.audit.iap_rules_engine.RuleViolation.resource_name" title="Permalink to this definition">¶</a></dt>
<dd><p>Alias for field number 2</p>
</dd></dl>

<dl class="attribute">
<dt id="google.cloud.security.scanner.audit.iap_rules_engine.RuleViolation.resource_type">
<code class="descname">resource_type</code><a class="headerlink" href="#google.cloud.security.scanner.audit.iap_rules_engine.RuleViolation.resource_type" title="Permalink to this definition">¶</a></dt>
<dd><p>Alias for field number 0</p>
</dd></dl>

<dl class="attribute">
<dt id="google.cloud.security.scanner.audit.iap_rules_engine.RuleViolation.rule_index">
<code class="descname">rule_index</code><a class="headerlink" href="#google.cloud.security.scanner.audit.iap_rules_engine.RuleViolation.rule_index" title="Permalink to this definition">¶</a></dt>
<dd><p>Alias for field number 4</p>
</dd></dl>

<dl class="attribute">
<dt id="google.cloud.security.scanner.audit.iap_rules_engine.RuleViolation.rule_name">
<code class="descname">rule_name</code><a class="headerlink" href="#google.cloud.security.scanner.audit.iap_rules_engine.RuleViolation.rule_name" title="Permalink to this definition">¶</a></dt>
<dd><p>Alias for field number 3</p>
</dd></dl>

<dl class="attribute">
<dt id="google.cloud.security.scanner.audit.iap_rules_engine.RuleViolation.violation_type">
<code class="descname">violation_type</code><a class="headerlink" href="#google.cloud.security.scanner.audit.iap_rules_engine.RuleViolation.violation_type" title="Permalink to this definition">¶</a></dt>
<dd><p>Alias for field number 5</p>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="module-google.cloud.security.scanner.audit.instance_network_interface_rules_engine">
<span id="google-cloud-security-scanner-audit-instance-network-interface-rules-engine-module"></span><h2>google.cloud.security.scanner.audit.instance_network_interface_rules_engine module<a class="headerlink" href="#module-google.cloud.security.scanner.audit.instance_network_interface_rules_engine" title="Permalink to this headline">¶</a></h2>
<p>Rules engine for NetworkInterface.</p>
<dl class="class">
<dt id="google.cloud.security.scanner.audit.instance_network_interface_rules_engine.InstanceNetworkInterfaceRuleBook">
<em class="property">class </em><code class="descclassname">google.cloud.security.scanner.audit.instance_network_interface_rules_engine.</code><code class="descname">InstanceNetworkInterfaceRuleBook</code><span class="sig-paren">(</span><em>rule_defs=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/google/cloud/security/scanner/audit/instance_network_interface_rules_engine.html#InstanceNetworkInterfaceRuleBook"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#google.cloud.security.scanner.audit.instance_network_interface_rules_engine.InstanceNetworkInterfaceRuleBook" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#google.cloud.security.scanner.audit.base_rules_engine.BaseRuleBook" title="google.cloud.security.scanner.audit.base_rules_engine.BaseRuleBook"><code class="xref py py-class docutils literal"><span class="pre">google.cloud.security.scanner.audit.base_rules_engine.BaseRuleBook</span></code></a></p>
<p>The RuleBook for enforced networks resources.</p>
<dl class="method">
<dt id="google.cloud.security.scanner.audit.instance_network_interface_rules_engine.InstanceNetworkInterfaceRuleBook.add_rule">
<code class="descname">add_rule</code><span class="sig-paren">(</span><em>rule_def</em>, <em>rule_index</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/google/cloud/security/scanner/audit/instance_network_interface_rules_engine.html#InstanceNetworkInterfaceRuleBook.add_rule"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#google.cloud.security.scanner.audit.instance_network_interface_rules_engine.InstanceNetworkInterfaceRuleBook.add_rule" title="Permalink to this definition">¶</a></dt>
<dd><p>Add a rule to the rule book.</p>
<p>Add a rule to the rule book.</p>
<p>The rule supplied to this method is the dictionary parsed from
the rules definition file.</p>
<p>For example, this rule...</p>
<dl class="docutils">
<dt># rules yaml:</dt>
<dd><blockquote class="first">
<div>rules:</div></blockquote>
<ul class="last">
<li><p class="first">name: all networks covered in whitelist
project: &#8216;*&#8217;
network: &#8216;*&#8217;
is_external_network: True
whitelist:</p>
<blockquote>
<div><dl class="docutils">
<dt>master:</dt>
<dd><ul class="first last simple">
<li>master-1</li>
</ul>
</dd>
<dt>network:</dt>
<dd><ul class="first last simple">
<li>network-1</li>
<li>network-2</li>
</ul>
</dd>
<dt>default:</dt>
<dd><ul class="first last simple">
<li>default-1</li>
</ul>
</dd>
</dl>
</div></blockquote>
</li>
</ul>
</dd>
</dl>
<p>... gets parsed into:
{</p>
<blockquote>
<div><dl class="docutils">
<dt>&#8220;rules&#8221;: [</dt>
<dd><dl class="first docutils">
<dt>{</dt>
<dd><p class="first">&#8220;name&#8221;: &#8220;all networks covered in whitelist&#8221;,
&#8220;project&#8221;: &#8220;*&#8221;,
&#8220;network&#8221;: &#8220;*&#8221;,
&#8220;is_external_network&#8221;: true,
&#8220;whitelist&#8221;: {</p>
<blockquote>
<div><dl class="docutils">
<dt>&#8220;master&#8221;: [</dt>
<dd>&#8220;master-1&#8221;</dd>
</dl>
<p>],
&#8220;network&#8221;: [</p>
<blockquote>
<div>&#8220;network-1&#8221;,
&#8220;network-2&#8221;</div></blockquote>
<p>],
&#8220;default&#8221;: [</p>
<blockquote>
<div>&#8220;default-1&#8221;</div></blockquote>
<p>]</p>
</div></blockquote>
<p class="last">}</p>
</dd>
</dl>
<p class="last">}</p>
</dd>
</dl>
<p>]</p>
</div></blockquote>
<p>}</p>
<dl class="docutils">
<dt>Args:</dt>
<dd><p class="first">rule_def (dict): A dictionary containing rule definition properties.
rule_index (int): The index of the rule from the rule definitions.</p>
<blockquote class="last">
<div>Assigned automatically when the rule book is built.</div></blockquote>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="google.cloud.security.scanner.audit.instance_network_interface_rules_engine.InstanceNetworkInterfaceRuleBook.add_rules">
<code class="descname">add_rules</code><span class="sig-paren">(</span><em>rule_defs</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/google/cloud/security/scanner/audit/instance_network_interface_rules_engine.html#InstanceNetworkInterfaceRuleBook.add_rules"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#google.cloud.security.scanner.audit.instance_network_interface_rules_engine.InstanceNetworkInterfaceRuleBook.add_rules" title="Permalink to this definition">¶</a></dt>
<dd><p>Add rules to the rule book.</p>
<dl class="docutils">
<dt>Args:</dt>
<dd>rule_defs (dict): rules definitions</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="google.cloud.security.scanner.audit.instance_network_interface_rules_engine.InstanceNetworkInterfaceRuleBook.get_resource_rules">
<code class="descname">get_resource_rules</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/google/cloud/security/scanner/audit/instance_network_interface_rules_engine.html#InstanceNetworkInterfaceRuleBook.get_resource_rules"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#google.cloud.security.scanner.audit.instance_network_interface_rules_engine.InstanceNetworkInterfaceRuleBook.get_resource_rules" title="Permalink to this definition">¶</a></dt>
<dd><p>Get all the resource rules.</p>
<dl class="docutils">
<dt>Return:</dt>
<dd>list: resource_rules_map values</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="google.cloud.security.scanner.audit.instance_network_interface_rules_engine.InstanceNetworkInterfaceRulesEngine">
<em class="property">class </em><code class="descclassname">google.cloud.security.scanner.audit.instance_network_interface_rules_engine.</code><code class="descname">InstanceNetworkInterfaceRulesEngine</code><span class="sig-paren">(</span><em>rules_file_path</em>, <em>snapshot_timestamp=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/google/cloud/security/scanner/audit/instance_network_interface_rules_engine.html#InstanceNetworkInterfaceRulesEngine"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#google.cloud.security.scanner.audit.instance_network_interface_rules_engine.InstanceNetworkInterfaceRulesEngine" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#google.cloud.security.scanner.audit.base_rules_engine.BaseRulesEngine" title="google.cloud.security.scanner.audit.base_rules_engine.BaseRulesEngine"><code class="xref py py-class docutils literal"><span class="pre">google.cloud.security.scanner.audit.base_rules_engine.BaseRulesEngine</span></code></a></p>
<p>Rules engine for InstanceNetworkInterfaceRules.</p>
<dl class="method">
<dt id="google.cloud.security.scanner.audit.instance_network_interface_rules_engine.InstanceNetworkInterfaceRulesEngine.add_rules">
<code class="descname">add_rules</code><span class="sig-paren">(</span><em>rules</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/google/cloud/security/scanner/audit/instance_network_interface_rules_engine.html#InstanceNetworkInterfaceRulesEngine.add_rules"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#google.cloud.security.scanner.audit.instance_network_interface_rules_engine.InstanceNetworkInterfaceRulesEngine.add_rules" title="Permalink to this definition">¶</a></dt>
<dd><p>Add rules to the rule book.</p>
<dl class="docutils">
<dt>Args:</dt>
<dd>rules (dicts): rule definitions</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="google.cloud.security.scanner.audit.instance_network_interface_rules_engine.InstanceNetworkInterfaceRulesEngine.build_rule_book">
<code class="descname">build_rule_book</code><span class="sig-paren">(</span><em>global_configs=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/google/cloud/security/scanner/audit/instance_network_interface_rules_engine.html#InstanceNetworkInterfaceRulesEngine.build_rule_book"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#google.cloud.security.scanner.audit.instance_network_interface_rules_engine.InstanceNetworkInterfaceRulesEngine.build_rule_book" title="Permalink to this definition">¶</a></dt>
<dd><p>Build InstanceNetworkInterfaceRuleBook from rules definition file.</p>
<dl class="docutils">
<dt>Args:</dt>
<dd>global_configs (dict): Global Configs</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="google.cloud.security.scanner.audit.instance_network_interface_rules_engine.InstanceNetworkInterfaceRulesEngine.find_policy_violations">
<code class="descname">find_policy_violations</code><span class="sig-paren">(</span><em>instance_network_interface</em>, <em>force_rebuild=False</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/google/cloud/security/scanner/audit/instance_network_interface_rules_engine.html#InstanceNetworkInterfaceRulesEngine.find_policy_violations"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#google.cloud.security.scanner.audit.instance_network_interface_rules_engine.InstanceNetworkInterfaceRulesEngine.find_policy_violations" title="Permalink to this definition">¶</a></dt>
<dd><p>Determine whether the networks violates rules.</p>
<dl class="docutils">
<dt>Args:</dt>
<dd><dl class="first docutils">
<dt>instance_network_interface (list): list of</dt>
<dd>instance_network_interface</dd>
</dl>
<p class="last">force_rebuild (bool): set to false to not force a rebuiid</p>
</dd>
<dt>Return:</dt>
<dd>list: iterator of all violations</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="google.cloud.security.scanner.audit.instance_network_interface_rules_engine.Rule">
<em class="property">class </em><code class="descclassname">google.cloud.security.scanner.audit.instance_network_interface_rules_engine.</code><code class="descname">Rule</code><span class="sig-paren">(</span><em>rule_name</em>, <em>rule_index</em>, <em>rules</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/google/cloud/security/scanner/audit/instance_network_interface_rules_engine.html#Rule"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#google.cloud.security.scanner.audit.instance_network_interface_rules_engine.Rule" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal"><span class="pre">object</span></code></p>
<p>The rules class for instance_network_interface.</p>
<dl class="class">
<dt id="google.cloud.security.scanner.audit.instance_network_interface_rules_engine.Rule.RuleViolation">
<em class="property">class </em><code class="descname">RuleViolation</code><span class="sig-paren">(</span><em>resource_type</em>, <em>resource_id</em>, <em>rule_name</em>, <em>rule_index</em>, <em>violation_type</em>, <em>project</em>, <em>network</em>, <em>ip</em>, <em>raw_data</em><span class="sig-paren">)</span><a class="headerlink" href="#google.cloud.security.scanner.audit.instance_network_interface_rules_engine.Rule.RuleViolation" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal"><span class="pre">tuple</span></code></p>
<dl class="attribute">
<dt id="google.cloud.security.scanner.audit.instance_network_interface_rules_engine.Rule.RuleViolation.ip">
<code class="descname">ip</code><a class="headerlink" href="#google.cloud.security.scanner.audit.instance_network_interface_rules_engine.Rule.RuleViolation.ip" title="Permalink to this definition">¶</a></dt>
<dd><p>Alias for field number 7</p>
</dd></dl>

<dl class="attribute">
<dt id="google.cloud.security.scanner.audit.instance_network_interface_rules_engine.Rule.RuleViolation.network">
<code class="descname">network</code><a class="headerlink" href="#google.cloud.security.scanner.audit.instance_network_interface_rules_engine.Rule.RuleViolation.network" title="Permalink to this definition">¶</a></dt>
<dd><p>Alias for field number 6</p>
</dd></dl>

<dl class="attribute">
<dt id="google.cloud.security.scanner.audit.instance_network_interface_rules_engine.Rule.RuleViolation.project">
<code class="descname">project</code><a class="headerlink" href="#google.cloud.security.scanner.audit.instance_network_interface_rules_engine.Rule.RuleViolation.project" title="Permalink to this definition">¶</a></dt>
<dd><p>Alias for field number 5</p>
</dd></dl>

<dl class="attribute">
<dt id="google.cloud.security.scanner.audit.instance_network_interface_rules_engine.Rule.RuleViolation.raw_data">
<code class="descname">raw_data</code><a class="headerlink" href="#google.cloud.security.scanner.audit.instance_network_interface_rules_engine.Rule.RuleViolation.raw_data" title="Permalink to this definition">¶</a></dt>
<dd><p>Alias for field number 8</p>
</dd></dl>

<dl class="attribute">
<dt id="google.cloud.security.scanner.audit.instance_network_interface_rules_engine.Rule.RuleViolation.resource_id">
<code class="descname">resource_id</code><a class="headerlink" href="#google.cloud.security.scanner.audit.instance_network_interface_rules_engine.Rule.RuleViolation.resource_id" title="Permalink to this definition">¶</a></dt>
<dd><p>Alias for field number 1</p>
</dd></dl>

<dl class="attribute">
<dt id="google.cloud.security.scanner.audit.instance_network_interface_rules_engine.Rule.RuleViolation.resource_type">
<code class="descname">resource_type</code><a class="headerlink" href="#google.cloud.security.scanner.audit.instance_network_interface_rules_engine.Rule.RuleViolation.resource_type" title="Permalink to this definition">¶</a></dt>
<dd><p>Alias for field number 0</p>
</dd></dl>

<dl class="attribute">
<dt id="google.cloud.security.scanner.audit.instance_network_interface_rules_engine.Rule.RuleViolation.rule_index">
<code class="descname">rule_index</code><a class="headerlink" href="#google.cloud.security.scanner.audit.instance_network_interface_rules_engine.Rule.RuleViolation.rule_index" title="Permalink to this definition">¶</a></dt>
<dd><p>Alias for field number 3</p>
</dd></dl>

<dl class="attribute">
<dt id="google.cloud.security.scanner.audit.instance_network_interface_rules_engine.Rule.RuleViolation.rule_name">
<code class="descname">rule_name</code><a class="headerlink" href="#google.cloud.security.scanner.audit.instance_network_interface_rules_engine.Rule.RuleViolation.rule_name" title="Permalink to this definition">¶</a></dt>
<dd><p>Alias for field number 2</p>
</dd></dl>

<dl class="attribute">
<dt id="google.cloud.security.scanner.audit.instance_network_interface_rules_engine.Rule.RuleViolation.violation_type">
<code class="descname">violation_type</code><a class="headerlink" href="#google.cloud.security.scanner.audit.instance_network_interface_rules_engine.Rule.RuleViolation.violation_type" title="Permalink to this definition">¶</a></dt>
<dd><p>Alias for field number 4</p>
</dd></dl>

</dd></dl>

<dl class="method">
<dt id="google.cloud.security.scanner.audit.instance_network_interface_rules_engine.Rule.find_violations">
<code class="descclassname">Rule.</code><code class="descname">find_violations</code><span class="sig-paren">(</span><em>instance_network_interface_list</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/google/cloud/security/scanner/audit/instance_network_interface_rules_engine.html#Rule.find_violations"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#google.cloud.security.scanner.audit.instance_network_interface_rules_engine.Rule.find_violations" title="Permalink to this definition">¶</a></dt>
<dd><p>Raise violation is the ip is not in the whitelist.</p>
<dl class="docutils">
<dt>Args:</dt>
<dd><blockquote class="first">
<div><dl class="docutils">
<dt>instance_network_interface_list (list): list</dt>
<dd>of InstanceNetworkInterface objects</dd>
</dl>
</div></blockquote>
<dl class="last docutils">
<dt>Yields:</dt>
<dd>namedtuple: Returns RuleViolation named tuple</dd>
</dl>
</dd>
</dl>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="module-google.cloud.security.scanner.audit.ke_version_rules_engine">
<span id="google-cloud-security-scanner-audit-ke-version-rules-engine-module"></span><h2>google.cloud.security.scanner.audit.ke_version_rules_engine module<a class="headerlink" href="#module-google.cloud.security.scanner.audit.ke_version_rules_engine" title="Permalink to this headline">¶</a></h2>
<p>Rules engine for verifying KE Versions are allowed.</p>
<dl class="class">
<dt id="google.cloud.security.scanner.audit.ke_version_rules_engine.KeVersionRuleBook">
<em class="property">class </em><code class="descclassname">google.cloud.security.scanner.audit.ke_version_rules_engine.</code><code class="descname">KeVersionRuleBook</code><span class="sig-paren">(</span><em>global_configs</em>, <em>rule_defs=None</em>, <em>snapshot_timestamp=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/google/cloud/security/scanner/audit/ke_version_rules_engine.html#KeVersionRuleBook"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#google.cloud.security.scanner.audit.ke_version_rules_engine.KeVersionRuleBook" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#google.cloud.security.scanner.audit.base_rules_engine.BaseRuleBook" title="google.cloud.security.scanner.audit.base_rules_engine.BaseRuleBook"><code class="xref py py-class docutils literal"><span class="pre">google.cloud.security.scanner.audit.base_rules_engine.BaseRuleBook</span></code></a></p>
<p>The RuleBook for KE Version rules.</p>
<dl class="method">
<dt id="google.cloud.security.scanner.audit.ke_version_rules_engine.KeVersionRuleBook.add_rule">
<code class="descname">add_rule</code><span class="sig-paren">(</span><em>rule_def</em>, <em>rule_index</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/google/cloud/security/scanner/audit/ke_version_rules_engine.html#KeVersionRuleBook.add_rule"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#google.cloud.security.scanner.audit.ke_version_rules_engine.KeVersionRuleBook.add_rule" title="Permalink to this definition">¶</a></dt>
<dd><p>Add a rule to the rule book.</p>
<dl class="docutils">
<dt>Args:</dt>
<dd><dl class="first last docutils">
<dt>rule_def (dict): A dictionary containing rule definition</dt>
<dd>properties.</dd>
<dt>rule_index (int): The index of the rule from the rule definitions.</dt>
<dd>Assigned automatically when the rule book is built.</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="google.cloud.security.scanner.audit.ke_version_rules_engine.KeVersionRuleBook.add_rules">
<code class="descname">add_rules</code><span class="sig-paren">(</span><em>rule_defs</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/google/cloud/security/scanner/audit/ke_version_rules_engine.html#KeVersionRuleBook.add_rules"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#google.cloud.security.scanner.audit.ke_version_rules_engine.KeVersionRuleBook.add_rules" title="Permalink to this definition">¶</a></dt>
<dd><p>Add rules to the rule book.</p>
<dl class="docutils">
<dt>Args:</dt>
<dd>rule_defs (dict): rule definitions dictionary</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="google.cloud.security.scanner.audit.ke_version_rules_engine.KeVersionRuleBook.find_violations">
<code class="descname">find_violations</code><span class="sig-paren">(</span><em>ke_cluster</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/google/cloud/security/scanner/audit/ke_version_rules_engine.html#KeVersionRuleBook.find_violations"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#google.cloud.security.scanner.audit.ke_version_rules_engine.KeVersionRuleBook.find_violations" title="Permalink to this definition">¶</a></dt>
<dd><p>Find violations in the rule book.</p>
<dl class="docutils">
<dt>Args:</dt>
<dd>ke_cluster (KeCluster): KE Cluster and ServerConfig data.</dd>
<dt>Returns:</dt>
<dd>list: RuleViolation</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="google.cloud.security.scanner.audit.ke_version_rules_engine.KeVersionRuleBook.get_resource_rules">
<code class="descname">get_resource_rules</code><span class="sig-paren">(</span><em>resource</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/google/cloud/security/scanner/audit/ke_version_rules_engine.html#KeVersionRuleBook.get_resource_rules"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#google.cloud.security.scanner.audit.ke_version_rules_engine.KeVersionRuleBook.get_resource_rules" title="Permalink to this definition">¶</a></dt>
<dd><p>Get all the resource rules for resource.</p>
<dl class="docutils">
<dt>Args:</dt>
<dd>resource (Resource): The gcp_type Resource find in the map.</dd>
<dt>Returns:</dt>
<dd>ResourceRules: A ResourceRules object.</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="google.cloud.security.scanner.audit.ke_version_rules_engine.KeVersionRulesEngine">
<em class="property">class </em><code class="descclassname">google.cloud.security.scanner.audit.ke_version_rules_engine.</code><code class="descname">KeVersionRulesEngine</code><span class="sig-paren">(</span><em>rules_file_path</em>, <em>snapshot_timestamp=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/google/cloud/security/scanner/audit/ke_version_rules_engine.html#KeVersionRulesEngine"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#google.cloud.security.scanner.audit.ke_version_rules_engine.KeVersionRulesEngine" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#google.cloud.security.scanner.audit.base_rules_engine.BaseRulesEngine" title="google.cloud.security.scanner.audit.base_rules_engine.BaseRulesEngine"><code class="xref py py-class docutils literal"><span class="pre">google.cloud.security.scanner.audit.base_rules_engine.BaseRulesEngine</span></code></a></p>
<p>Rules engine for KE Version scanner.</p>
<dl class="method">
<dt id="google.cloud.security.scanner.audit.ke_version_rules_engine.KeVersionRulesEngine.build_rule_book">
<code class="descname">build_rule_book</code><span class="sig-paren">(</span><em>global_configs=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/google/cloud/security/scanner/audit/ke_version_rules_engine.html#KeVersionRulesEngine.build_rule_book"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#google.cloud.security.scanner.audit.ke_version_rules_engine.KeVersionRulesEngine.build_rule_book" title="Permalink to this definition">¶</a></dt>
<dd><p>Build CloudSQLRuleBook from the rules definition file.</p>
<dl class="docutils">
<dt>Args:</dt>
<dd>global_configs (dict): Global configurations.</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="google.cloud.security.scanner.audit.ke_version_rules_engine.KeVersionRulesEngine.find_policy_violations">
<code class="descname">find_policy_violations</code><span class="sig-paren">(</span><em>ke_cluster</em>, <em>force_rebuild=False</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/google/cloud/security/scanner/audit/ke_version_rules_engine.html#KeVersionRulesEngine.find_policy_violations"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#google.cloud.security.scanner.audit.ke_version_rules_engine.KeVersionRulesEngine.find_policy_violations" title="Permalink to this definition">¶</a></dt>
<dd><p>Determine whether CloudSQL acls violates rules.</p>
<dl class="docutils">
<dt>Args:</dt>
<dd><p class="first">ke_cluster (KeCluster): A KE Cluster object to check.
force_rebuild (bool): If True, rebuilds the rule book. This will</p>
<blockquote class="last">
<div>reload the rules definition file and add the rules to the book.</div></blockquote>
</dd>
<dt>Returns:</dt>
<dd>generator: A generator of rule violations.</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="google.cloud.security.scanner.audit.ke_version_rules_engine.ResourceRules">
<em class="property">class </em><code class="descclassname">google.cloud.security.scanner.audit.ke_version_rules_engine.</code><code class="descname">ResourceRules</code><span class="sig-paren">(</span><em>resource=None</em>, <em>rules=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/google/cloud/security/scanner/audit/ke_version_rules_engine.html#ResourceRules"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#google.cloud.security.scanner.audit.ke_version_rules_engine.ResourceRules" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal"><span class="pre">object</span></code></p>
<p>An association of a resource to rules.</p>
<dl class="method">
<dt id="google.cloud.security.scanner.audit.ke_version_rules_engine.ResourceRules.find_policy_violations">
<code class="descname">find_policy_violations</code><span class="sig-paren">(</span><em>ke_cluster</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/google/cloud/security/scanner/audit/ke_version_rules_engine.html#ResourceRules.find_policy_violations"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#google.cloud.security.scanner.audit.ke_version_rules_engine.ResourceRules.find_policy_violations" title="Permalink to this definition">¶</a></dt>
<dd><p>Determine if the policy binding matches this rule&#8217;s criteria.</p>
<dl class="docutils">
<dt>Args:</dt>
<dd>ke_cluster (keCluster): KE Cluster and ServerConfig data.</dd>
<dt>Returns:</dt>
<dd>list: RuleViolation</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="google.cloud.security.scanner.audit.ke_version_rules_engine.Rule">
<em class="property">class </em><code class="descclassname">google.cloud.security.scanner.audit.ke_version_rules_engine.</code><code class="descname">Rule</code><span class="sig-paren">(</span><em>rule_name</em>, <em>rule_index</em>, <em>check_serverconfig_valid_node_versions</em>, <em>check_serverconfig_valid_master_versions</em>, <em>allowed_nodepool_versions</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/google/cloud/security/scanner/audit/ke_version_rules_engine.html#Rule"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#google.cloud.security.scanner.audit.ke_version_rules_engine.Rule" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal"><span class="pre">object</span></code></p>
<p>Rule properties from the rule definition file, also finds violations.</p>
<dl class="method">
<dt id="google.cloud.security.scanner.audit.ke_version_rules_engine.Rule.find_policy_violations">
<code class="descname">find_policy_violations</code><span class="sig-paren">(</span><em>ke_cluster</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/google/cloud/security/scanner/audit/ke_version_rules_engine.html#Rule.find_policy_violations"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#google.cloud.security.scanner.audit.ke_version_rules_engine.Rule.find_policy_violations" title="Permalink to this definition">¶</a></dt>
<dd><p>Find KE Version violations in based on the rule.</p>
<dl class="docutils">
<dt>Args:</dt>
<dd>ke_cluster (KeCluster): KE Cluster and ServerConfig data.</dd>
<dt>Returns:</dt>
<dd>list: Returns a list of RuleViolation named tuples</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="google.cloud.security.scanner.audit.ke_version_rules_engine.RuleViolation">
<em class="property">class </em><code class="descclassname">google.cloud.security.scanner.audit.ke_version_rules_engine.</code><code class="descname">RuleViolation</code><span class="sig-paren">(</span><em>resource_type</em>, <em>resource_id</em>, <em>rule_name</em>, <em>rule_index</em>, <em>violation_type</em>, <em>violation_reason</em>, <em>project_id</em>, <em>cluster_name</em>, <em>node_pool_name</em><span class="sig-paren">)</span><a class="headerlink" href="#google.cloud.security.scanner.audit.ke_version_rules_engine.RuleViolation" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal"><span class="pre">tuple</span></code></p>
<dl class="attribute">
<dt id="google.cloud.security.scanner.audit.ke_version_rules_engine.RuleViolation.cluster_name">
<code class="descname">cluster_name</code><a class="headerlink" href="#google.cloud.security.scanner.audit.ke_version_rules_engine.RuleViolation.cluster_name" title="Permalink to this definition">¶</a></dt>
<dd><p>Alias for field number 7</p>
</dd></dl>

<dl class="attribute">
<dt id="google.cloud.security.scanner.audit.ke_version_rules_engine.RuleViolation.node_pool_name">
<code class="descname">node_pool_name</code><a class="headerlink" href="#google.cloud.security.scanner.audit.ke_version_rules_engine.RuleViolation.node_pool_name" title="Permalink to this definition">¶</a></dt>
<dd><p>Alias for field number 8</p>
</dd></dl>

<dl class="attribute">
<dt id="google.cloud.security.scanner.audit.ke_version_rules_engine.RuleViolation.project_id">
<code class="descname">project_id</code><a class="headerlink" href="#google.cloud.security.scanner.audit.ke_version_rules_engine.RuleViolation.project_id" title="Permalink to this definition">¶</a></dt>
<dd><p>Alias for field number 6</p>
</dd></dl>

<dl class="attribute">
<dt id="google.cloud.security.scanner.audit.ke_version_rules_engine.RuleViolation.resource_id">
<code class="descname">resource_id</code><a class="headerlink" href="#google.cloud.security.scanner.audit.ke_version_rules_engine.RuleViolation.resource_id" title="Permalink to this definition">¶</a></dt>
<dd><p>Alias for field number 1</p>
</dd></dl>

<dl class="attribute">
<dt id="google.cloud.security.scanner.audit.ke_version_rules_engine.RuleViolation.resource_type">
<code class="descname">resource_type</code><a class="headerlink" href="#google.cloud.security.scanner.audit.ke_version_rules_engine.RuleViolation.resource_type" title="Permalink to this definition">¶</a></dt>
<dd><p>Alias for field number 0</p>
</dd></dl>

<dl class="attribute">
<dt id="google.cloud.security.scanner.audit.ke_version_rules_engine.RuleViolation.rule_index">
<code class="descname">rule_index</code><a class="headerlink" href="#google.cloud.security.scanner.audit.ke_version_rules_engine.RuleViolation.rule_index" title="Permalink to this definition">¶</a></dt>
<dd><p>Alias for field number 3</p>
</dd></dl>

<dl class="attribute">
<dt id="google.cloud.security.scanner.audit.ke_version_rules_engine.RuleViolation.rule_name">
<code class="descname">rule_name</code><a class="headerlink" href="#google.cloud.security.scanner.audit.ke_version_rules_engine.RuleViolation.rule_name" title="Permalink to this definition">¶</a></dt>
<dd><p>Alias for field number 2</p>
</dd></dl>

<dl class="attribute">
<dt id="google.cloud.security.scanner.audit.ke_version_rules_engine.RuleViolation.violation_reason">
<code class="descname">violation_reason</code><a class="headerlink" href="#google.cloud.security.scanner.audit.ke_version_rules_engine.RuleViolation.violation_reason" title="Permalink to this definition">¶</a></dt>
<dd><p>Alias for field number 5</p>
</dd></dl>

<dl class="attribute">
<dt id="google.cloud.security.scanner.audit.ke_version_rules_engine.RuleViolation.violation_type">
<code class="descname">violation_type</code><a class="headerlink" href="#google.cloud.security.scanner.audit.ke_version_rules_engine.RuleViolation.violation_type" title="Permalink to this definition">¶</a></dt>
<dd><p>Alias for field number 4</p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="google.cloud.security.scanner.audit.ke_version_rules_engine.VersionRule">
<em class="property">class </em><code class="descclassname">google.cloud.security.scanner.audit.ke_version_rules_engine.</code><code class="descname">VersionRule</code><span class="sig-paren">(</span><em>major</em>, <em>minor=None</em>, <em>operator='='</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/google/cloud/security/scanner/audit/ke_version_rules_engine.html#VersionRule"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#google.cloud.security.scanner.audit.ke_version_rules_engine.VersionRule" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal"><span class="pre">object</span></code></p>
<p>Class to match allowed versions rules against running versions.</p>
<dl class="attribute">
<dt id="google.cloud.security.scanner.audit.ke_version_rules_engine.VersionRule.ALLOWED_OPERATORS">
<code class="descname">ALLOWED_OPERATORS</code><em class="property"> = {'=': &lt;built-in function eq&gt;, '&lt;=': &lt;built-in function le&gt;, '&gt;=': &lt;built-in function ge&gt;, '&lt;': &lt;built-in function lt&gt;, '&gt;': &lt;built-in function gt&gt;}</em><a class="headerlink" href="#google.cloud.security.scanner.audit.ke_version_rules_engine.VersionRule.ALLOWED_OPERATORS" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="google.cloud.security.scanner.audit.ke_version_rules_engine.VersionRule.is_version_allowed">
<code class="descname">is_version_allowed</code><span class="sig-paren">(</span><em>version</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/google/cloud/security/scanner/audit/ke_version_rules_engine.html#VersionRule.is_version_allowed"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#google.cloud.security.scanner.audit.ke_version_rules_engine.VersionRule.is_version_allowed" title="Permalink to this definition">¶</a></dt>
<dd><p>Check if the version matches the allowed_version configuration.</p>
<dl class="docutils">
<dt>Args:</dt>
<dd>version (str): A version string. e.g. &#8216;1.6.11.gke.1&#8217;</dd>
<dt>Returns:</dt>
<dd>bool: True if version is allowed, else False</dd>
</dl>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="module-google.cloud.security.scanner.audit.rules">
<span id="google-cloud-security-scanner-audit-rules-module"></span><h2>google.cloud.security.scanner.audit.rules module<a class="headerlink" href="#module-google.cloud.security.scanner.audit.rules" title="Permalink to this headline">¶</a></h2>
<p>Rules-related classes.</p>
<dl class="class">
<dt id="google.cloud.security.scanner.audit.rules.Rule">
<em class="property">class </em><code class="descclassname">google.cloud.security.scanner.audit.rules.</code><code class="descname">Rule</code><span class="sig-paren">(</span><em>rule_name</em>, <em>rule_index</em>, <em>bindings</em>, <em>mode=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/google/cloud/security/scanner/audit/rules.html#Rule"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#google.cloud.security.scanner.audit.rules.Rule" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal"><span class="pre">object</span></code></p>
<p>Encapsulate Rule properties from the rule definition file.</p>
<p>The reason this is not a named tuple is that it needs to be hashable.
The ResourceRules class has a set of Rules.</p>
</dd></dl>

<dl class="class">
<dt id="google.cloud.security.scanner.audit.rules.RuleAppliesTo">
<em class="property">class </em><code class="descclassname">google.cloud.security.scanner.audit.rules.</code><code class="descname">RuleAppliesTo</code><a class="reference internal" href="../_modules/google/cloud/security/scanner/audit/rules.html#RuleAppliesTo"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#google.cloud.security.scanner.audit.rules.RuleAppliesTo" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal"><span class="pre">object</span></code></p>
<p>What the rule applies to. (Default: SELF)</p>
<dl class="attribute">
<dt id="google.cloud.security.scanner.audit.rules.RuleAppliesTo.CHILDREN">
<code class="descname">CHILDREN</code><em class="property"> = 'children'</em><a class="headerlink" href="#google.cloud.security.scanner.audit.rules.RuleAppliesTo.CHILDREN" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="google.cloud.security.scanner.audit.rules.RuleAppliesTo.SELF">
<code class="descname">SELF</code><em class="property"> = 'self'</em><a class="headerlink" href="#google.cloud.security.scanner.audit.rules.RuleAppliesTo.SELF" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="google.cloud.security.scanner.audit.rules.RuleAppliesTo.SELF_AND_CHILDREN">
<code class="descname">SELF_AND_CHILDREN</code><em class="property"> = 'self_and_children'</em><a class="headerlink" href="#google.cloud.security.scanner.audit.rules.RuleAppliesTo.SELF_AND_CHILDREN" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="google.cloud.security.scanner.audit.rules.RuleAppliesTo.apply_types">
<code class="descname">apply_types</code><em class="property"> = frozenset(['self', 'children', 'self_and_children'])</em><a class="headerlink" href="#google.cloud.security.scanner.audit.rules.RuleAppliesTo.apply_types" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="classmethod">
<dt id="google.cloud.security.scanner.audit.rules.RuleAppliesTo.verify">
<em class="property">classmethod </em><code class="descname">verify</code><span class="sig-paren">(</span><em>applies_to</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/google/cloud/security/scanner/audit/rules.html#RuleAppliesTo.verify"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#google.cloud.security.scanner.audit.rules.RuleAppliesTo.verify" title="Permalink to this definition">¶</a></dt>
<dd><p>Verify whether the applies_to is valid.</p>
<dl class="docutils">
<dt>Args:</dt>
<dd>applies_to (str): What the rule applies to.</dd>
<dt>Returns:</dt>
<dd>str: The applies_to property.</dd>
<dt>Raises:</dt>
<dd>InvalidRulesSchemaError if applies_to is not valid.</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="google.cloud.security.scanner.audit.rules.RuleMode">
<em class="property">class </em><code class="descclassname">google.cloud.security.scanner.audit.rules.</code><code class="descname">RuleMode</code><a class="reference internal" href="../_modules/google/cloud/security/scanner/audit/rules.html#RuleMode"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#google.cloud.security.scanner.audit.rules.RuleMode" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal"><span class="pre">object</span></code></p>
<p>The rule mode.</p>
<dl class="attribute">
<dt id="google.cloud.security.scanner.audit.rules.RuleMode.BLACKLIST">
<code class="descname">BLACKLIST</code><em class="property"> = 'blacklist'</em><a class="headerlink" href="#google.cloud.security.scanner.audit.rules.RuleMode.BLACKLIST" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="google.cloud.security.scanner.audit.rules.RuleMode.MATCHES">
<code class="descname">MATCHES</code><em class="property"> = 'matches'</em><a class="headerlink" href="#google.cloud.security.scanner.audit.rules.RuleMode.MATCHES" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="google.cloud.security.scanner.audit.rules.RuleMode.REQUIRED">
<code class="descname">REQUIRED</code><em class="property"> = 'required'</em><a class="headerlink" href="#google.cloud.security.scanner.audit.rules.RuleMode.REQUIRED" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="google.cloud.security.scanner.audit.rules.RuleMode.WHITELIST">
<code class="descname">WHITELIST</code><em class="property"> = 'whitelist'</em><a class="headerlink" href="#google.cloud.security.scanner.audit.rules.RuleMode.WHITELIST" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="google.cloud.security.scanner.audit.rules.RuleMode.modes">
<code class="descname">modes</code><em class="property"> = frozenset(['blacklist', 'matches', 'whitelist', 'required'])</em><a class="headerlink" href="#google.cloud.security.scanner.audit.rules.RuleMode.modes" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="classmethod">
<dt id="google.cloud.security.scanner.audit.rules.RuleMode.verify">
<em class="property">classmethod </em><code class="descname">verify</code><span class="sig-paren">(</span><em>mode</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/google/cloud/security/scanner/audit/rules.html#RuleMode.verify"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#google.cloud.security.scanner.audit.rules.RuleMode.verify" title="Permalink to this definition">¶</a></dt>
<dd><p>Verify whether the mode is valid.</p>
<dl class="docutils">
<dt>Args:</dt>
<dd>mode (str): The rules mode.</dd>
<dt>Returns:</dt>
<dd>str: The rules mode property.</dd>
<dt>Raises:</dt>
<dd>InvalidRulesSchemaError if mode is not valid.</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="google.cloud.security.scanner.audit.rules.RuleViolation">
<em class="property">class </em><code class="descclassname">google.cloud.security.scanner.audit.rules.</code><code class="descname">RuleViolation</code><span class="sig-paren">(</span><em>resource_type</em>, <em>resource_id</em>, <em>rule_name</em>, <em>rule_index</em>, <em>violation_type</em>, <em>role</em>, <em>members</em><span class="sig-paren">)</span><a class="headerlink" href="#google.cloud.security.scanner.audit.rules.RuleViolation" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal"><span class="pre">tuple</span></code></p>
<dl class="attribute">
<dt id="google.cloud.security.scanner.audit.rules.RuleViolation.members">
<code class="descname">members</code><a class="headerlink" href="#google.cloud.security.scanner.audit.rules.RuleViolation.members" title="Permalink to this definition">¶</a></dt>
<dd><p>Alias for field number 6</p>
</dd></dl>

<dl class="attribute">
<dt id="google.cloud.security.scanner.audit.rules.RuleViolation.resource_id">
<code class="descname">resource_id</code><a class="headerlink" href="#google.cloud.security.scanner.audit.rules.RuleViolation.resource_id" title="Permalink to this definition">¶</a></dt>
<dd><p>Alias for field number 1</p>
</dd></dl>

<dl class="attribute">
<dt id="google.cloud.security.scanner.audit.rules.RuleViolation.resource_type">
<code class="descname">resource_type</code><a class="headerlink" href="#google.cloud.security.scanner.audit.rules.RuleViolation.resource_type" title="Permalink to this definition">¶</a></dt>
<dd><p>Alias for field number 0</p>
</dd></dl>

<dl class="attribute">
<dt id="google.cloud.security.scanner.audit.rules.RuleViolation.role">
<code class="descname">role</code><a class="headerlink" href="#google.cloud.security.scanner.audit.rules.RuleViolation.role" title="Permalink to this definition">¶</a></dt>
<dd><p>Alias for field number 5</p>
</dd></dl>

<dl class="attribute">
<dt id="google.cloud.security.scanner.audit.rules.RuleViolation.rule_index">
<code class="descname">rule_index</code><a class="headerlink" href="#google.cloud.security.scanner.audit.rules.RuleViolation.rule_index" title="Permalink to this definition">¶</a></dt>
<dd><p>Alias for field number 3</p>
</dd></dl>

<dl class="attribute">
<dt id="google.cloud.security.scanner.audit.rules.RuleViolation.rule_name">
<code class="descname">rule_name</code><a class="headerlink" href="#google.cloud.security.scanner.audit.rules.RuleViolation.rule_name" title="Permalink to this definition">¶</a></dt>
<dd><p>Alias for field number 2</p>
</dd></dl>

<dl class="attribute">
<dt id="google.cloud.security.scanner.audit.rules.RuleViolation.violation_type">
<code class="descname">violation_type</code><a class="headerlink" href="#google.cloud.security.scanner.audit.rules.RuleViolation.violation_type" title="Permalink to this definition">¶</a></dt>
<dd><p>Alias for field number 4</p>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="module-google.cloud.security.scanner.audit">
<span id="module-contents"></span><h2>Module contents<a class="headerlink" href="#module-google.cloud.security.scanner.audit" title="Permalink to this headline">¶</a></h2>
<p>Rules engine auditing module.</p>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <h3><a href="../index.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">google.cloud.security.scanner.audit package</a><ul>
<li><a class="reference internal" href="#submodules">Submodules</a></li>
<li><a class="reference internal" href="#module-google.cloud.security.scanner.audit.base_rules_engine">google.cloud.security.scanner.audit.base_rules_engine module</a></li>
<li><a class="reference internal" href="#module-google.cloud.security.scanner.audit.bigquery_rules_engine">google.cloud.security.scanner.audit.bigquery_rules_engine module</a></li>
<li><a class="reference internal" href="#module-google.cloud.security.scanner.audit.blacklist_rules_engine">google.cloud.security.scanner.audit.blacklist_rules_engine module</a></li>
<li><a class="reference internal" href="#module-google.cloud.security.scanner.audit.buckets_rules_engine">google.cloud.security.scanner.audit.buckets_rules_engine module</a></li>
<li><a class="reference internal" href="#module-google.cloud.security.scanner.audit.cloudsql_rules_engine">google.cloud.security.scanner.audit.cloudsql_rules_engine module</a></li>
<li><a class="reference internal" href="#module-google.cloud.security.scanner.audit.errors">google.cloud.security.scanner.audit.errors module</a></li>
<li><a class="reference internal" href="#module-google.cloud.security.scanner.audit.firewall_rules_engine">google.cloud.security.scanner.audit.firewall_rules_engine module</a></li>
<li><a class="reference internal" href="#module-google.cloud.security.scanner.audit.forwarding_rule_rules_engine">google.cloud.security.scanner.audit.forwarding_rule_rules_engine module</a></li>
<li><a class="reference internal" href="#module-google.cloud.security.scanner.audit.iam_rules_engine">google.cloud.security.scanner.audit.iam_rules_engine module</a></li>
<li><a class="reference internal" href="#module-google.cloud.security.scanner.audit.iap_rules_engine">google.cloud.security.scanner.audit.iap_rules_engine module</a></li>
<li><a class="reference internal" href="#module-google.cloud.security.scanner.audit.instance_network_interface_rules_engine">google.cloud.security.scanner.audit.instance_network_interface_rules_engine module</a></li>
<li><a class="reference internal" href="#module-google.cloud.security.scanner.audit.ke_version_rules_engine">google.cloud.security.scanner.audit.ke_version_rules_engine module</a></li>
<li><a class="reference internal" href="#module-google.cloud.security.scanner.audit.rules">google.cloud.security.scanner.audit.rules module</a></li>
<li><a class="reference internal" href="#module-google.cloud.security.scanner.audit">Module contents</a></li>
</ul>
</li>
</ul>
<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="../index.html">Documentation overview</a><ul>
  </ul></li>
</ul>
</div>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="../_sources/source/google.cloud.security.scanner.audit.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2018, The Forseti Security Authors.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 1.3.6</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.7</a>
      
      |
      <a href="../_sources/source/google.cloud.security.scanner.audit.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>